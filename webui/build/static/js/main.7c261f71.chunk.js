(this.webpackJsonpwebui=this.webpackJsonpwebui||[]).push([[0],{192:function(e,t,n){},193:function(e,t,n){},223:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n(0),r=n.n(c),o=n(15),i=n.n(o),s=(n(192),n(193),n(266)),l=n(267),d=n(102),u=n(268),j=n(25),b=n(151),p=n(269),m=function(e){var t=Object(j.a)(),n=Object(b.a)({palette:{primary:{light:s.a[600],main:s.a[800],dark:s.a[800],contrastText:t.palette.getContrastText(s.a[800])},accent:{light:l.a[200],main:l.a[500],dark:l.a[800],contrastText:t.palette.getContrastText(l.a[500])},secondary:{light:s.a[600],main:s.a[700],dark:s.a[800],contrastText:t.palette.getContrastText(s.a[600])},secondaryRed:{light:d.a[600],main:d.a[700],dark:d.a[800],contrastText:t.palette.getContrastText(d.a[600])},notSelected:{light:u.a[500],main:u.a[700],dark:u.a[800],contrastText:t.palette.getContrastText(u.a[600])},error:{light:d.a[200],main:d.a[500],dark:d.a[800],contrastText:t.palette.getContrastText(d.a[500])},record:{light:d.a[900],main:d.a[900],dark:d.a[900],contrastText:t.palette.getContrastText(d.a[500])}}});return Object(a.jsx)(p.a,{theme:n,children:e.children})},h=n(8),O=n(271),f=n(273),x=n(68),g=n(76),v=function(){var e=Object(g.a)((function(e){return{navbarDisplayFlex:{display:"flex",justifyContent:"space-between"},navDisplayFlex:{display:"flex-right",justifyContent:"space-between"},linkText:{textDecoration:"none",textTransform:"uppercase",color:"white"},appBar:{zIndex:e.zIndex.drawer+1}}}))();return Object(a.jsx)(O.a,{position:"static",className:e.appBar,children:Object(a.jsx)(f.a,{children:Object(a.jsx)(x.a,{variant:"h6",children:"SensiML Gateway"})})})},S=n(274),C=n(103),y=n(101),w=n(275),D=n(226),T=n(227),R=n(228),k=n(276),N=n(144),_=n.n(N),E=n(145),I=n.n(E),A=n(143),M=n.n(A),W=n(277),L=n(110),G=n.n(L),z=Object(g.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerContainer:{overflow:"auto"},content:{flexGrow:1,padding:e.spacing(3)},section1:{margin:e.spacing(2,1)}}})),P=function(e){switch(e.index){case 0:return Object(a.jsx)(M.a,{});case 1:return Object(a.jsx)(_.a,{});default:return Object(a.jsx)(I.a,{})}},B=function(e){return Object(a.jsx)(S.a,{children:e.isConnected?Object(a.jsxs)(x.a,{children:[" ",Object(a.jsx)(G.a,{style:{fontSize:16,color:C.a[500]}})," Connected  "]}):Object(a.jsxs)(x.a,{children:[" ",Object(a.jsx)(G.a,{style:{fontSize:16,color:y.a[500]},children:" "}),"  Not Connected "]})})},U=function(e){var t=z();return Object(a.jsxs)(w.a,{className:t.drawer,variant:"permanent",classes:{paper:t.drawerPaper},children:[Object(a.jsx)(f.a,{}),Object(a.jsx)("div",{className:t.drawerContainer,children:Object(a.jsxs)(D.a,{children:[["Home","Test Mode"].map((function(t,n){return Object(a.jsxs)(T.a,{button:!0,onClick:(c=n,function(t){e.onChange(c)}),children:[Object(a.jsx)(R.a,{children:Object(a.jsx)(P,{index:n,children:" "})}),Object(a.jsx)(k.a,{primary:t})]},t);var c})),Object(a.jsx)("div",{className:t.section1,children:Object(a.jsx)(W.a,{})}),Object(a.jsx)(T.a,{children:Object(a.jsx)(x.a,{color:"primary",children:"Device Status"})}),Object(a.jsx)(T.a,{children:Object(a.jsx)(B,{text:"Device",isConnected:e.isConnected})}),Object(a.jsx)(T.a,{children:Object(a.jsx)(x.a,{color:"primary",children:"Video Status"})}),Object(a.jsx)(T.a,{children:Object(a.jsx)(B,{text:"Video",isConnected:e.isCameraConnected})})]})})]})},F=n(26),H=function(){return Object(g.a)((function(e){return{root:{display:"flex"},toolbar:Object(F.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar),content:{flexGrow:1,width:"100%",padding:e.spacing(5,5,5,35),justifyContent:"flex-end"}}}))()},q=n(21),V=n.n(q),J=Object(g.a)({root:{minWidth:275},bullet:{transform:"scale(1.0)"},title:{fontSize:20,backgroundColor:"#e0e0e0"},pos:{marginBottom:2,marginTop:2}}),K=function(e){var t=J();return Object(a.jsxs)(S.a,{item:!0,xs:e.xs,children:[Object(a.jsx)(x.a,{align:"center",className:t.title,color:"textPrimary",children:e.name}),e.list?Object(a.jsx)("div",{className:t.bullet,children:Object(a.jsx)(D.a,{dense:!0,children:e.value.split(",").map((function(e){return Object(a.jsx)(T.a,{children:Object(a.jsx)(k.a,{align:"center",primary:e})})}))})}):Object(a.jsx)(x.a,{align:"center",className:t.pos,color:"textSecondary",children:e.value})]})},Q=Object(g.a)((function(e){return{details:{display:"flex",flexDirection:"column"},content:{flex:"1 0 auto"},controls:{display:"flex",alignItems:"center"},section1:{margin:e.spacing(2,0,2,0)}}})),X=function(e){Q(),Object(j.a)();return Object(a.jsxs)(S.a,{container:!0,rows:!0,spacing:4,children:[Object(a.jsxs)(S.a,{item:!0,xs:12,container:!0,rows:!0,spacing:2,children:[Object(a.jsx)(K,{name:"Mode",xs:"6",value:e.config.mode}),Object(a.jsx)(K,{name:"Source",xs:"6",value:e.config.source})]}),Object(a.jsxs)(S.a,{item:!0,xs:12,container:!0,rows:!0,spacing:2,children:[Object(a.jsx)(K,{name:"Device ID",xs:6,value:e.config.device_id}),"data_capture"===e.config.mode?Object(a.jsx)(K,{xs:"6",name:"Sample Rate",value:e.config.sample_rate}):null]}),Object(a.jsx)(S.a,{item:!0,xs:12,children:"data_capture"===e.config.mode?Object(a.jsx)(K,{name:"Sensor Columns",value:e.config.column_location,list:!0}):null})]})},Y=n(69),Z=n(284),$=n(285),ee=n(77),te=n(231),ne=n(229),ae=n(288),ce=n(290),re=n(163),oe=n(280),ie=n(283),se=n(281),le=n(95),de=n(282),ue=Object(g.a)((function(e){return{root:{display:"flex"},formControl:{margin:e.spacing(3),minWidth:600},button:{margin:e.spacing(1,1,0,0)},section1:{margin:e.spacing(1,1)}}}));function je(e){var t=r.a.useState(!1),n=Object(h.a)(t,2),c=n[0],o=n[1],i=r.a.useState(!1),s=Object(h.a)(i,2),l=(s[0],s[1]),d=r.a.useState([]),u=Object(h.a)(d,2),j=u[0],b=u[1],p=r.a.useState(""),m=Object(h.a)(p,2),O=(m[0],m[1]),f=r.a.useState(!1),x=Object(h.a)(f,2),g=(x[0],x[1],ue()),v=r.a.useState("Scanning"),S=Object(h.a)(v,2),C=S[0],y=S[1],w=function(){o(!1)},D=function(){y("Scanning for "+e.source+" Devices...."),l(!0),V.a.post("".concat("/","scan"),{source:e.source.toLowerCase()}).then((function(e){console.log(e.data),l(!1),b(e.data),y("Scanning complete")})).catch((function(e){l(!1),e.response?(O(e.response.data.detail.join(", ")),console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers)):e.request?console.log(e.request):console.log("Error",e.detail)}))};return Object(a.jsxs)("div",{children:[Object(a.jsxs)(Y.a,{variant:"outlined",color:"primary",disabled:e.configuring,fullWidth:!0,onClick:function(e){b([]),o(!0),e.preventDefault(),D()},className:g.button,children:["Scan for ",e.source," Devices"]}),Object(a.jsxs)(oe.a,{open:c,onClose:w,fullWidth:"sm",maxWidth:"sm",children:[Object(a.jsxs)(se.a,{children:[Object(a.jsx)(de.a,{children:C}),Object(a.jsx)("div",{style:{height:600,width:"100%"},children:Object(a.jsx)(le.a,{rows:j,columns:[{field:"id",headerName:"ID",width:0},{field:"device_id",headerName:"Device ID",width:240},{field:"name",headerName:"Name",width:240}],onRowSelected:e.handleRowSelection,pageSize:10})})]}),Object(a.jsx)(ie.a,{children:Object(a.jsx)(Y.a,{onClick:w,color:"primary",autoFocus:!0,children:"select"})})]})]})}var be=function(e){return console.log(e),Object(a.jsx)("img",{src:"http://localhost:5555/stream-video?"+e.cameraKey,alt:"Camera Not Started."})},pe=Object(g.a)((function(e){return{root:{display:"flex"},details:{display:"flex",flexDirection:"column"},content:{flex:"1 0 auto"},controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)},section1:{margin:e.spacing(2,0,3,0)},section2:{margin:e.spacing(2),textAlign:"center"},divWrapper:{margin:e.spacing(3),padding:e.spacing(2,2,2,2),maxWidth:800,minHeight:800}}})),me=function(e,t,n,a){console.log(e),V.a.post("".concat("/","config-video"),{camera_index:0,event_type:e}).then((function(c){console.log(c.data),"camera-on"==e&&(t(!0),n(!0),a(Math.random().toString(36).substring(7)),console.log("caera event"),console.log(e)),"camera-off"==e&&(t(!1),n(!1),console.log("caera event"),console.log(e))}))},he=function(e){var t=pe(),n=r.a.useState(!1),c=Object(h.a)(n,2),o=(c[0],c[1]),i=r.a.useState(""),s=Object(h.a)(i,2),l=s[0],d=s[1];return Object(a.jsxs)("div",{children:[Object(a.jsx)("div",{className:t.section1,children:Object(a.jsx)(x.a,{component:"h3",variant:"h3",color:"secondary",children:"Video Source"})}),Object(a.jsx)("div",{className:t.section1,children:Object(a.jsx)(W.a,{variant:"middle"})}),Object(a.jsx)(be,{cameraKey:l,cameraView:e.isCameraConnected}),Object(a.jsx)("div",{className:t.section2,children:Object(a.jsx)(x.a,{variant:"subtitle1",color:"textSecondary"})}),Object(a.jsx)("div",{className:t.details,children:Object(a.jsx)(S.a,{container:!0,rows:!0,spacing:2,children:Object(a.jsx)(S.a,{item:!0,xs:12,children:!1===e.isCameraConnected?Object(a.jsx)(Y.a,{"aria-label":"Start Camera",variant:"contained",color:"primary",fullWidth:!0,onClick:function(){me("camera-on",o,e.setIsCameraConnected,d)},children:"Connect to Camera"}):Object(a.jsx)(Y.a,{"aria-label":"Stop Camera",color:"primary",variant:"contained",fullWidth:!0,onClick:function(){me("camera-off",o,e.setIsCameraConnected,d)},children:"Disconnect From Camera"})})})})]})},Oe=Object(g.a)((function(e){return{root:{display:"flex"},formControl:{margin:e.spacing(3),minWidth:600},divWrapper:{margin:e.spacing(3),padding:e.spacing(2,2,2,2),maxWidth:700,minWidth:600},button:{margin:e.spacing(1,1,0,0)},section1:{margin:e.spacing(2,0,1,0)}}})),fe=function(e){var t=Oe(),n=r.a.useState(e.streamingSource?e.streamingSource:"SERIAL"),o=Object(h.a)(n,2),i=o[0],s=o[1],l=r.a.useState("recognition"===e.streamingMode?"RECOGNITION":"DATA_CAPTURE"),d=Object(h.a)(l,2),u=d[0],j=d[1],b=r.a.useState(e.deviceID),p=Object(h.a)(b,2),m=p[0],O=p[1],f=r.a.useState(!1),g=Object(h.a)(f,2),v=g[0],C=g[1],y=r.a.useState(""),w=Object(h.a)(y,2),D=(w[0],w[1]),T=r.a.useState(!1),R=Object(h.a)(T,2),k=R[0],N=R[1],_=Object(c.useState)(!1),E=Object(h.a)(_,2),I=(E[0],E[1]);function A(t){t.mode&&e.setStreamingMode(t.mode),e.setIsConnected(t.streaming),e.setColumns(Object.keys(t.column_location).sort()),e.setStreamingSource(t.source),e.setDeviceID(t.device_id),e.setIsCameraConnected(t.camera_on),t.column_location="column_location"in t?Object.keys(t.column_location).sort().join(", "):[],e.setConfig(t)}return Object(c.useEffect)((function(){O(e.deviceID),s(e.streamingSource),j(e.streamingMode.toUpperCase())}),[e.deviceID,e.streamingMode]),Object(a.jsxs)(S.a,{container:!0,columns:!0,children:[Object(a.jsx)(S.a,{item:!0,children:Object(a.jsx)(Z.a,{className:t.divWrapper,children:Object(a.jsxs)($.a,{children:[Object(a.jsx)("div",{className:t.section1,children:Object(a.jsx)(x.a,{component:"h3",variant:"h3",color:"secondary",children:"Device Source"})}),Object(a.jsx)("div",{className:t.section1,children:Object(a.jsx)(W.a,{variant:"middle"})}),e.isConnected?Object(a.jsxs)(r.a.Fragment,{children:[Object(a.jsx)(X,{setStreamingMode:e.setStreamingMode,setColumns:e.setColumns,setStreamingSource:e.setStreamingSource,setDeviceID:e.setDeviceID,setIsConnected:e.setIsConnected,isConnected:e.isConnected,setIsCameraConnected:e.setIsCameraConnected,isCameraConnected:e.isCameraConnected,config:e.config}),Object(a.jsx)(Y.a,{type:"submit",variant:"contained",color:"primary",disabled:k,fullWidth:!0,className:t.button,onClick:function(e){I(!0),V.a.get("".concat("/","disconnect")).then((function(e){console.log(e.data),A(e.data),I(!1)}))},children:"Disconnect from Device"})]}):Object(a.jsx)(r.a.Fragment,{children:Object(a.jsx)("form",{onSubmit:function(e){if(N(!0),e.preventDefault(),""===m)return D("Must Set DeviceID"),void N(!1);console.log(i),console.log(m),V.a.post("".concat("/","config"),{device_id:m,source:i.toLowerCase(),mode:u}).then((function(e){A(e.data),D("Gateway Connected to device, now ready to stream."),N(!1)})).catch((function(e){N(!1),e.response?(D(e.response.data.detail.join(", ")),console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers)):e.request?console.log(e.request):console.log("Error",e.detail)}))},children:Object(a.jsxs)(ee.a,{component:"fieldset",disabled:k||e.isConnected,error:v,className:t.formControl,children:[Object(a.jsxs)("div",{children:[Object(a.jsx)(ne.a,{component:"legend",children:"Device Mode:"}),Object(a.jsxs)(ce.a,{"aria-label":"mode",name:"Streaming Source",value:u,onChange:function(e){console.log("handle mode"),j(e.target.value)},row:!0,children:[Object(a.jsx)(te.a,{value:"DATA_CAPTURE",control:Object(a.jsx)(ae.a,{}),label:"Data Capture"}),Object(a.jsx)(te.a,{value:"RECOGNITION",control:Object(a.jsx)(ae.a,{}),label:"Recognition"})]})]}),Object(a.jsx)("div",{className:t.section1}),Object(a.jsxs)("div",{children:[Object(a.jsx)(ne.a,{children:"Connection Type"}),Object(a.jsxs)(ce.a,{"aria-label":"source",value:i,onChange:function(e){console.log("handle radio"),s(e.target.value)},row:!0,children:[Object(a.jsx)(te.a,{value:"SERIAL",control:Object(a.jsx)(ae.a,{}),label:"Serial"}),Object(a.jsx)(te.a,{value:"BLE",control:Object(a.jsx)(ae.a,{}),label:"BLE"}),Object(a.jsx)(te.a,{value:"TCPIP",control:Object(a.jsx)(ae.a,{}),label:"TCP/IP"}),Object(a.jsx)(te.a,{value:"TEST",control:Object(a.jsx)(ae.a,{}),label:"Test"})]})]}),Object(a.jsx)(je,{source:i,handleRowSelection:function(e){console.log(e.data.device_id),O(e.data.device_id)},configuring:k}),Object(a.jsx)("div",{className:t.section1}),Object(a.jsxs)("div",{children:[Object(a.jsx)(ne.a,{component:"legend",children:"Device ID:"}),Object(a.jsx)(re.a,{id:"outlined-basic",variant:"outlined",value:m,onChange:function(e){console.log("handle device id"),O(e.target.value),D(" "),C(!1)},fullWidth:!0})]}),Object(a.jsx)("div",{className:t.section1}),Object(a.jsx)("div",{children:Object(a.jsx)(S.a,{container:!0,columns:!0,spacing:2,children:Object(a.jsx)(S.a,{item:!0,xs:12,children:Object(a.jsx)(Y.a,{type:"submit",variant:"contained",color:"primary",disabled:k,fullWidth:!0,className:t.button,children:"Connect to Device"})})})})]})})})]})})}),Object(a.jsx)(S.a,{item:!0,children:Object(a.jsx)(Z.a,{className:t.divWrapper,children:Object(a.jsx)($.a,{children:Object(a.jsx)(he,{setIsCameraConnected:e.setIsCameraConnected,isCameraConnected:e.isCameraConnected})})})})]})},xe=n(287),ge=n(232),ve=n(41),Se="SET_GLOBAL_LOADER",Ce="FETCH_DATA_ERROR_MSG",ye="SET_DATA_ERROR_MSG",we="START_STREAM_SENSOR_SAGA",De="STOP_STREAM_SENSOR_SAGA",Te="SET_IS_STREAMING_SENSOR",Re="SET_IS_STREAMING_SENSOR_RECORDING",ke="SET_STREAM_SENSOR_DATA_RESET",Ne="SET_CHUNK_SENSOR_DATA_SAGA",_e="SET_STREAM_SENSOR_DATA",Ee="SET_STREAM_SENSOR_RECORD_DATA",Ie=n(149),Ae=n.n(Ie),Me=function(e){var t=e.sensorData,n=(e.countSamples,e.title),r=Object(c.useState)(0),o=Object(h.a)(r,2),i=o[0],s=o[1],l=Object(c.useState)("1"),d=Object(h.a)(l,2),u=d[0];d[1];return Object(c.useEffect)((function(){s(i+1),t&&t.length&&t[0].x&&t[0].x.length}),[t]),Object(a.jsx)(Ae.a,{data:t,revision:i,style:{width:"100%",height:"100%",opacity:u},layout:{title:n,visible:!1,autosize:!0,margin:{l:50,r:50,b:100,t:100,pad:4},xaxis:{autorange:!0},yaxis:{autorange:!0}}})},We=Object(g.a)((function(e){return{cardWrapper:{padding:e.spacing(2)},dataWrapper:{padding:e.spacing(2)},chartWrapper:{width:"100%",margin:e.spacing(1)},buttonWrapper:{display:"flex",marginTop:e.spacing(2)},button:{marginLeft:e.spacing(2)},zeroOpacity:{opacity:"0"}}})),Le=function(e){var t,n=1e3,r=e.columns,o=We(),i=Object(ve.b)(),s=Object(c.useState)(!1),l=Object(h.a)(s,2),d=l[0],u=l[1],j=Object(ve.c)((function(e){return e.stream})),b=j.isStreamingSensor,p=(j.isStreamingSensorRecording,Object(ve.c)((t=r,function(e){var n=e.sensorData.sensorSimpleData;console.log("HEREE"),console.log(n);var a=t.map((function(e){return{x:[],y:[],type:"scatter",mode:"lines",name:e}}));return n.forEach((function(e,n){a[n%t.length].x.push(Math.floor(n/t.length)),a[n%t.length].y.push(e)})),a}))),m=Object(c.useCallback)((function(){return i({type:we,payload:{countSamples:n*(r&&(null===r||void 0===r?void 0:r.length)||1)}})}),[i]),O=Object(c.useCallback)((function(){return i({type:De})}),[i]),f=Object(c.useCallback)((function(){return i({type:ke,payload:[]})}),[i]);return Object(c.useEffect)((function(){!e.isConnected&&b&&(O(),f())}),[]),Object(a.jsx)(Z.a,{children:Object(a.jsxs)($.a,{children:[Object(a.jsx)(x.a,{component:"h3",variant:"h3",color:"secondary",children:"Test Mode: Data Capture"}),Object(a.jsxs)(xe.a,{className:o.dataWrapper,children:[Object(a.jsxs)(xe.a,{className:o.chartWrapper,children:[Object(a.jsxs)(xe.a,{className:!b&&o.zeroOpacity,children:[Object(a.jsx)(ge.a,{checked:d,onChange:function(){u(!d)},inputProps:{"aria-label":"secondary checkbox"}})," ","Split charts"]}),p&&p.length&&d?p.map((function(e){return Object(a.jsx)(Me,{title:e.name,countSamples:n,sensorData:[e],isStreamingSensor:b})})):Object(a.jsx)(Me,{countSamples:n,sensorData:p,isStreamingSensor:b})]}),Object(a.jsx)(xe.a,{className:o.buttonWrapper,children:Object(a.jsx)(Y.a,{variant:"contained",color:"primary",className:o.button,onClick:function(){return console.log("streaming",b),void(b?O():(f(),m()))},children:b?"Stop":"View"})})]})]})})},Ge=n(22),ze=n(291),Pe=function(e){return Object(a.jsx)(x.a,{align:"center",variant:"h1",component:"h2",children:function(e,t){if(0===e.length)return"No Results";t>e.length&&(t=e.length-1);for(var n={},a=e.length-t;a<e.length;a++)e[a].Classification in n?n[e[a].Classification]+=1:n[e[a].Classification]=1;for(var c=0,r=0,o=0,i=Object.entries(n);o<i.length;o++){var s=Object(h.a)(i[o],2),l=s[0],d=s[1];d>r&&(r=d,c=l)}return r<t/2?"UNC":c}(e.data,e.filter_length)})},Be=0,Ue=Object(g.a)((function(e){return{controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)},root:{width:"800px"},sliderroot:{width:"100%"},sliderinput:{width:42},section1:{margin:e.spacing(3,2)},section2:{margin:e.spacing(2),textAlign:"center"}}}));var Fe=function(e,t,n,a,c){Be=0,n([]),a(!0),fetch(t,{method:"GET"}).then((function(e){var t=e.body.getReader();c(t);var r=new ReadableStream({start:function(e){!function c(){t.read().then((function(t){var r=t.done,o=t.value;if(r)return a(!1),void e.close();for(var i=function(e){var t=String.fromCharCode.apply(null,e).split("\n");return t.pop(),t.map((function(e){return JSON.parse(e)}))}(o),s=0;s<i.length;s++)console.log(i[s]),i[s].id=Be,Be+=1,n((function(e){return[].concat(Object(Ge.a)(e),[i[s]])}));c()}))}()}});return new Response(r,{headers:{"Content-Type":"text/html"}})}))};var He=function(e){var t=r.a.useState([]),n=Object(h.a)(t,2),c=n[0],o=n[1],i=r.a.useState(!1),s=Object(h.a)(i,2),l=s[0],d=s[1],u=r.a.useState(),b=Object(h.a)(u,2),p=b[0],m=b[1],O=r.a.useState(1),f=Object(h.a)(O,2),g=f[0],v=f[1],C=Ue();Object(j.a)();return Object(a.jsx)(Z.a,{children:Object(a.jsxs)($.a,{children:[Object(a.jsxs)("div",{className:C.section1,children:[Object(a.jsx)(S.a,{item:!0,xs:12,children:Object(a.jsx)(x.a,{align:"center",component:"h2",variant:"h2",color:"secondary",children:"Test Mode: Recognition"})}),Object(a.jsx)("div",{className:C.section1,children:Object(a.jsx)(W.a,{variant:"middle"})}),Object(a.jsx)(S.a,{item:!0,xs:12,children:l?Object(a.jsx)("div",{className:C.controls,children:Object(a.jsx)(Y.a,{"aria-label":"disconnect",color:"primary",variant:"contained",fullWidth:!0,onClick:function(){!function(e,t,n){console.log(t),t.cancel(),n(!1)}(0,p,d)},children:"Stop Stream"})}):Object(a.jsx)("div",{className:C.controls,children:Object(a.jsx)(Y.a,{"aria-label":"disconnect",color:"primary",variant:"contained",fullWidth:!0,onClick:function(){Fe(0,"".concat("/","results"),o,d,m)},children:"Start Stream"})})})]}),Object(a.jsx)(S.a,{item:!0,alignContent:"center",xs:12,children:Object(a.jsx)(Pe,{data:c,filter_length:g})}),Object(a.jsx)("div",{className:C.section1,children:Object(a.jsx)(W.a,{variant:"middle"})}),Object(a.jsx)(x.a,{align:"left",color:"primary",component:"h5",variant:"h5",children:"Post Processing"}),Object(a.jsx)("div",{className:C.section1,children:Object(a.jsx)(W.a,{variant:"middle"})}),Object(a.jsxs)(S.a,{container:!0,spacing:4,rows:!0,alignItems:"center",children:[Object(a.jsx)(S.a,{item:!0,xs:4,children:Object(a.jsx)(x.a,{align:"center",component:"h6",variant:"h6",children:"Buffer"})}),Object(a.jsx)(S.a,{item:!0,xs:6,children:Object(a.jsx)("div",{className:C.sliderroot,children:Object(a.jsx)(ze.a,{value:"number"===typeof g?g:1,onChange:function(e,t){console.log(t),v(t)},"aria-labelledby":"input-slider",min:1,max:10})})}),Object(a.jsx)(S.a,{item:!0,xs:1,children:Object(a.jsx)(x.a,{align:"center",component:"h6",variant:"h6",children:g})})]}),Object(a.jsx)("div",{className:C.section1,children:Object(a.jsx)("div",{style:{height:600,width:"100%"},children:Object(a.jsx)(le.a,{rows:c,columns:[{field:"id",headerName:"ID",width:70},{field:"source",headerName:"Device ID",width:240},{field:"ModelNumber",headerName:"Model ID",width:240},{field:"Classification",headerName:"Classification",width:240}],pageSize:15,sortModel:[{field:"id",sort:"desc"}]})})})]})})},qe=n(115),Ve=Object(g.a)((function(e){return{root:{display:"flex"},details:{display:"flex",flexDirection:"column"},content:{flex:"1 0 auto"},controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)},section1:{margin:e.spacing(3,2)},section2:{margin:e.spacing(2),textAlign:"center"}}})),Je=function(e){var t=Ve(),n=(Object(j.a)(),r.a.useState(e.isRecording)),c=Object(h.a)(n,2),o=c[0],i=c[1],s=r.a.useState("filename"),l=Object(h.a)(s,2),d=l[0],u=l[1],b=r.a.useState(!1),p=Object(h.a)(b,2),m=p[0],O=p[1];console.log("Connected Camera"),console.log(e.isCameraConnected);var f=function(e,t,n,a){O(!0),console.log(e),""===a&&(a="test"),console.log(a),V.a.post("".concat("/")+t,{filename:a,event_type:e}).then((function(t){console.log(t.data),"record-start"==e&&(n(!0),console.log(e)),"record-stop"==e&&(n(!1),console.log(e)),O(!1)})).catch((function(e){console.log(e),O(!1)}))};return Object(a.jsx)(Z.a,{children:Object(a.jsxs)($.a,{children:[Object(a.jsx)("div",{className:t.section1,children:Object(a.jsx)(x.a,{component:"h4",variant:"h4",color:"secondary",children:"Record to Gateway"})}),Object(a.jsx)(W.a,{variant:"middle"}),Object(a.jsx)("div",{className:t.section2,children:Object(a.jsx)(x.a,{variant:"subtitle1",color:"textSecondary"})}),Object(a.jsxs)(S.a,{container:!0,columns:!0,spacing:6,children:[Object(a.jsx)(S.a,{item:!0,xs:12,children:Object(a.jsx)(re.a,{id:"outlined-basic",variant:"outlined",value:d,onChange:function(e){u(e.target.value)},fullWidth:!0,disabled:o})}),Object(a.jsx)(S.a,{item:!0,xs:6,children:!1===o?Object(a.jsx)(qe.a,{title:"This will record the device sensor data in .csv format to the gateway. If video source is connected, the video source will also be recorded. ","aria-label":"record",children:Object(a.jsx)(Y.a,{"aria-label":"Record",variant:"contained",fullWidth:!0,disabled:m,onClick:function(){f("record-start",e.isCameraConnected?"record":"record-device",i,d)},children:"Record"})}):Object(a.jsx)(Y.a,{"aria-label":"Stop ",variant:"contained",fullWidth:!0,disabled:m,onClick:function(){f("record-stop",e.isCameraConnected?"record":"record-device",i)},children:"Stop Recording"})}),Object(a.jsx)(S.a,{item:!0,xs:6,children:Object(a.jsx)(qe.a,{title:"Download the recorded .csv and .mp4 for this capture from the gateway. A .dcli file will also be generated describing the data. ","aria-label":"record",children:Object(a.jsx)(Y.a,{"aria-label":"Download ",variant:"contained",fullWidth:!0,disabled:m,onClick:function(){!function(e,t){console.log("".concat("/","download/")+t),fetch("".concat("/","download/")+t,{method:"GET",headers:{"Content-Type":"application/zip"}}).then((function(e){return e.blob()})).then((function(e){var n=window.URL.createObjectURL(new Blob([e])),a=document.createElement("a");a.href=n,a.setAttribute("download",t+".zip"),document.body.appendChild(a),a.click(),a.parentNode.removeChild(a)}))}(0,d)},children:"Download"})})})]})]})})},Ke=(Object(g.a)((function(e){return{root:{display:"flex"},details:{display:"flex",flexDirection:"column"},content:{flex:"1 0 auto"},controls:{display:"flex",alignItems:"center"},section1:{margin:e.spacing(3,2)}}})),function(e){return Object(a.jsxs)(S.a,{container:!0,rows:!0,spacing:6,children:["recognition"!=e.streamingMode?Object(a.jsx)(S.a,{item:!0,xs:8,children:Object(a.jsx)(Le,{columns:e.columns,isConnected:e.isConnected})}):Object(a.jsx)(S.a,{item:!0,xs:6,children:Object(a.jsx)(He,{})}),Object(a.jsx)(S.a,{item:!0,xs:4,children:Object(a.jsx)(Je,{isCameraConnected:e.isCameraConnected,isRecording:e.isRecording})})]})}),Qe=n(286),Xe=n(99),Ye=function(){var e=Object(ve.b)(),t=r.a.useState(0),n=Object(h.a)(t,2),o=n[0],i=n[1],s=r.a.useState("DATA_CAPTURE"),l=Object(h.a)(s,2),d=l[0],u=l[1],j=r.a.useState(null),b=Object(h.a)(j,2),p=b[0],m=b[1],O=r.a.useState([]),f=Object(h.a)(O,2),x=f[0],g=f[1],C=r.a.useState([]),y=Object(h.a)(C,2),w=y[0],D=y[1],T=r.a.useState(!1),R=Object(h.a)(T,2),k=R[0],N=R[1],_=r.a.useState(!1),E=Object(h.a)(_,2),I=E[0],A=E[1],M=r.a.useState(!1),W=Object(h.a)(M,2),L=W[0],G=(W[1],r.a.useState({})),z=Object(h.a)(G,2),P=z[0],B=z[1],F=r.a.useState(null),q=Object(h.a)(F,2),J=(q[0],q[1],Object(Xe.b)()),K=J.enqueueSnackbar,Q=(J.closeSnackbar,Object(ve.c)((function(e){return e.stream})).isStreamingSensor),X=Object(ve.c)((function(e){return e.errors})).errorDataMsg;function Y(e){e.mode&&u(e.mode),N(e.streaming),g(Object.keys(e.column_location).sort()),m(e.source.toUpperCase()),D(e.device_id),A(e.camera_on),e.column_location="column_location"in e?Object.keys(e.column_location).sort().join(", "):[],B(e)}var Z=function(e){Q&&(e.preventDefault(),e.returnValue="")},$=Object(c.useCallback)((function(){return e({type:De})}),[e]);Object(c.useEffect)((function(){if(Q)return window.addEventListener("beforeunload",Z),window.addEventListener("unload",$),function(){window.removeEventListener("beforeunload",Z),window.removeEventListener("unload",$),$()}}),[Q]),Object(c.useEffect)((function(){X&&K(X,{variant:"warning"})}),[X]),Object(c.useEffect)((function(){V.a.get("".concat("/","config"),{}).then((function(e){Y(e.data),console.log(e.data)}))}),[o]),Object(c.useLayoutEffect)((function(){V.a.get("".concat("/","config"),{}).then((function(e){Y(e.data)}))}),[]);var ee=H();return Object(a.jsxs)("div",{className:ee.root,children:[Object(a.jsx)(Qe.a,{}),Object(a.jsxs)(S.a,{container:!0,direction:"column",justify:"center",alignItems:"center",children:[Object(a.jsx)(v,{}),Object(a.jsx)(U,{onChange:function(e){o!==e&&i(e)},isConnected:k,isCameraConnected:I}),Object(a.jsxs)("main",{className:ee.content,children:[0===o?Object(a.jsx)(fe,{streamingMode:d,deviceID:w,setStreamingMode:u,setColumns:g,setStreamingSource:m,setDeviceID:D,setIsConnected:N,isConnected:k,setIsCameraConnected:A,isCameraConnected:I,config:P,setConfig:B,streamingSource:p}):null,1===o?Object(a.jsx)(Ke,{columns:x,streamingMode:d,isConnected:k,isRecording:L,isCameraConnected:I,setIsCameraConnected:A,samplerate:P.samplerate}):null]})]})]})},Ze=n(152),$e=n(39),et=n(150),tt=n(14),nt=n.n(tt),at=n(18),ct=nt.a.mark(ot),rt=nt.a.mark(it);function ot(e){return nt.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(at.e)({type:ye,payload:e.payload});case 2:return t.next=4,Object(at.c)(1e3);case 4:return t.next=6,Object(at.e)({type:ye,payload:null});case 6:case"end":return t.stop()}}),ct)}function it(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(at.g)(Ce,ot);case 2:case"end":return e.stop()}}),rt)}var st=n(66),lt=n(55),dt=n(75),ut=n(96),jt=n(100),bt=n(153),pt=function(e){Object(ut.a)(n,e);var t=Object(jt.a)(n);function n(e,a){var c;return Object(lt.a)(this,n),(c=t.call(this)).detail=500!==e?a.detail:"Server Error. Please, contact support.",c.name=c.constructor.name,c.errorCode=e,c}return n}(Object(bt.a)(Error)),mt=function(){function e(t){Object(lt.a)(this,e),this.reader=void 0,this.fetchUrl=t}return Object(dt.a)(e,[{key:"startStreaming",value:function(){var e=Object(st.a)(nt.a.mark((function e(){var t;return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getting response"),e.prev=1,e.next=4,fetch(this.fetchUrl);case 4:t=e.sent,e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(1),console.log(e.t0),new pt(404,{detail:"Failed to fetch API service"});case 11:if(t.ok){e.next=13;break}throw new pt(t.status,{detail:t.statusText});case 13:console.log("getting reader"),this.reader=t.body.getReader();case 15:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"stopStreaming",value:function(){var e=Object(st.a)(nt.a.mark((function e(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.reader&&(this.reader.cancel(),this.reader=void 0);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readStreamToRedux",value:function(){var e=Object(st.a)(nt.a.mark((function e(t){var n,a,c,r=arguments;return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.length>1&&void 0!==r[1]?r[1]:0;case 1:return e.next=4,this.reader.read();case 4:if(a=e.sent,c=a.value,!a.done){e.next=9;break}return e.abrupt("break",12);case 9:Xt.dispatch({type:t,payload:{chunk:new Int16Array(c.buffer),countSamples:n}}),e.next=1;break;case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),ht="/",Ot=void 0,ft=nt.a.mark(gt),xt=nt.a.mark(vt);function gt(e){var t,n;return nt.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,t=null===e||void 0===e?void 0:e.payload,n=t.countSamples,a.next=4,Object(at.b)([Ot,"startStreaming"]);case 4:return a.next=6,Object(at.e)({type:Te,payload:!0});case 6:return a.next=8,Object(at.b)([Ot,"readStreamToRedux"],Ne,n);case 8:a.next=20;break;case 10:if(a.prev=10,a.t0=a.catch(0),console.debug(a.t0),!(a.t0 instanceof pt)){a.next=18;break}return a.next=16,Object(at.e)({type:Ce,payload:a.t0.detail});case 16:a.next=20;break;case 18:return a.next=20,Object(at.e)({type:Ce,payload:"Failed to read stream data"});case 20:case"end":return a.stop()}}),ft,null,[[0,10]])}function vt(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(at.h)(we,gt);case 2:case"end":return e.stop()}}),xt)}var St=nt.a.mark(yt),Ct=nt.a.mark(wt);function yt(e){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(at.b)([Ot,"stopStreaming"]);case 3:return e.next=5,Object(at.e)({type:Te,payload:!1});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.debug(e.t0);case 10:case"end":return e.stop()}}),St,null,[[0,7]])}function wt(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(at.h)(De,yt);case 2:case"end":return e.stop()}}),Ct)}var Dt=nt.a.mark(Tt);function Tt(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(at.a)([Object(at.d)(vt),Object(at.d)(wt)]);case 2:case"end":return e.stop()}}),Dt)}var Rt=nt.a.mark(Nt),kt=nt.a.mark(_t);function Nt(e){var t,n,a,c,r,o,i,s,l,d,u,j,b,p;return nt.a.wrap((function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,t=e.payload,n=t.chunk,a=t.countSamples,c=n&&n.length||0,r=[],m.next=6,Object(at.f)((function(e){return e.sensorData}));case 6:return o=m.sent,i=o.sensorSimpleData,s=o.sensorRecordedData,m.next=11,Object(at.f)((function(e){return e.stream}));case 11:if(l=m.sent,d=l.isStreamingSensorRecording,console.log("called",c/12),c>=a)r=Object(Ge.a)(n);else if(i.length>=a)for(r=Object(Ge.a)(i),u=[0,i.length,0],j=u[0],b=u[1],p=u[2];j<b;)b-j>c?r[j]=i[j+c]:(r[j]=n[p],p++),j++;else r=[].concat(Object(Ge.a)(i),Object(Ge.a)(n));return m.next=17,Object(at.e)({type:_e,payload:r});case 17:if(!d){m.next=20;break}return m.next=20,Object(at.e)({type:Ee,payload:[].concat(Object(Ge.a)(s),Object(Ge.a)(n))});case 20:m.next=25;break;case 22:m.prev=22,m.t0=m.catch(0),console.debug(m.t0);case 25:case"end":return m.stop()}}),Rt,null,[[0,22]])}function _t(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(at.h)(Ne,Nt);case 2:case"end":return e.stop()}}),kt)}var Et=nt.a.mark(It);function It(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(at.a)([Object(at.d)(_t)]);case 2:case"end":return e.stop()}}),Et)}var At=nt.a.mark(Mt);function Mt(){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(at.a)([Object(at.d)(Tt),Object(at.d)(it),Object(at.d)(It)]);case 2:case"end":return e.stop()}}),At)}var Wt={globalLoader:!1};function Lt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Se:return Object(F.a)(Object(F.a)({},e),{},{globalLoader:t.payload||!1});default:return e}}var Gt={errorDataMsg:null};function zt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ye:return Object(F.a)(Object(F.a)({},e),{},{errorDataMsg:t.payload});default:return e}}var Pt={isStreamingSensor:!1,isStreamingSensorRecording:!1};function Bt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Te:return Object(F.a)(Object(F.a)({},e),{},{isStreamingSensor:t.payload});case Re:return Object(F.a)(Object(F.a)({},e),{},{isStreamingSensorRecording:t.payload});default:return e}}var Ut={sensorSimpleData:new Int16Array,sensorRecordedData:new Int16Array};function Ft(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ut,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ke:return Object(F.a)(Object(F.a)({},e),{},{sensorSimpleData:new Int16Array,sensorRecordedData:new Int16Array});case _e:return Object(F.a)(Object(F.a)({},e),{},{sensorSimpleData:Object(Ge.a)(t.payload)});case Ee:return Object(F.a)(Object(F.a)({},e),{},{sensorRecordedData:Object(Ge.a)(t.payload)});default:return e}}var Ht=function(){return Object($e.combineReducers)({root:Lt,errors:zt,stream:Bt,sensorData:Ft})},qt=Object(Ze.a)(),Vt=[qt],Jt=et.composeWithDevTools.apply(void 0,[$e.applyMiddleware.apply(void 0,Vt)].concat([])),Kt=Ht(),Qt=Object($e.createStore)(Kt,Jt);qt.run(Mt);var Xt=Qt;({interceptor_401:null,refreshUrl:"/auth/refresh",init:function(e){V.a.defaults.baseURL=e},mount401Interceptor:function(){this.interceptor_401=V.a.interceptors.response.use((function(e){return e}),function(){var e=Object(st.a)(nt.a.mark((function e(t){return nt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(401!==t.request.status){e.next=5;break}if(!t.config.url.includes("auth")){e.next=5;break}throw t;case 5:throw t;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},unmount401Interceptor:function(){V.a.interceptors.response.eject(this.interceptor_401)},setCustomAuthHeader:function(e){V.a.defaults.headers.common.Authorization=e},setContentType:function(e){V.a.defaults.headers.contentType=e},removeHeader:function(){V.a.defaults.headers.common={}},get:function(e){return V.a.get(e)},post:function(e,t){return V.a.post(e,t)},put:function(e,t){return V.a.put(e,t)},delete:function(e){return V.a.delete(e)},customRequest:function(e){return V()(e)},customJsonRequest:function(e){return this.setAuthHeader(),this.setContentType("application/json"),V()(e)}}).init(ht),Ot=new mt("".concat(ht,"stream"));var Yt=function(){return Object(a.jsx)(m,{children:Object(a.jsx)(ve.a,{store:Xt,children:Object(a.jsx)(Xe.a,{anchorOrigin:{horizontal:"right",vertical:"top"},autoHideDuration:2e3,children:Object(a.jsx)(Ye,{})})})})};i.a.render(Object(a.jsx)(Yt,{}),document.getElementById("root"))}},[[223,1,2]]]);
//# sourceMappingURL=main.7c261f71.chunk.js.map