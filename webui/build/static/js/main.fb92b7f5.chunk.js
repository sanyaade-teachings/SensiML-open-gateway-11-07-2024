(this.webpackJsonpwebui=this.webpackJsonpwebui||[]).push([[0],{205:function(e,t,a){},207:function(e,t,a){},239:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(18),s=a.n(r),i=(a(205),a(10)),o=a.n(i),l=a(46),d=(a(207),a(287)),u=a(288),j=a(109),b=a(289),p=a(27),h=a(64),m=a(290),O=a(2),f=function(e){var t=Object(p.a)(),a=Object(h.a)({palette:{primary:{light:d.a[600],main:d.a[800],dark:d.a[800],contrastText:t.palette.getContrastText(d.a[800])},accent:{light:u.a[200],main:u.a[500],dark:u.a[800],contrastText:t.palette.getContrastText(u.a[500])},secondary:{light:d.a[600],main:d.a[700],dark:d.a[800],contrastText:t.palette.getContrastText(d.a[600])},secondaryRed:{light:j.a[600],main:j.a[700],dark:j.a[800],contrastText:t.palette.getContrastText(j.a[600])},notSelected:{light:b.a[500],main:b.a[700],dark:b.a[800],contrastText:t.palette.getContrastText(b.a[600])},error:{light:j.a[200],main:j.a[500],dark:j.a[800],contrastText:t.palette.getContrastText(j.a[500])},record:{light:j.a[900],main:j.a[900],dark:j.a[900],contrastText:t.palette.getContrastText(j.a[500])}}});return Object(O.jsx)(m.a,{theme:a,children:e.children})},x=a(6),g=a(293),v=a(294),y=a(75),S=a(140),C=function(){var e=Object(S.a)((function(e){return{navbarDisplayFlex:{display:"flex",justifyContent:"space-between"},navDisplayFlex:{display:"flex-right",justifyContent:"space-between"},linkText:{textDecoration:"none",textTransform:"uppercase",color:"white"},appBar:{zIndex:e.zIndex.drawer+1}}}))();return Object(O.jsx)(g.a,{position:"static",className:e.appBar,children:Object(O.jsx)(v.a,{children:Object(O.jsx)(y.a,{variant:"h6",children:"SensiML Gateway"})})})},w=a(295),_=a(70),D=a(110),k=a(108),T=a(296),I=a(245),R=a(246),N=a(247),E=a(297),A=a(157),M=a.n(A),L=a(158),W=a.n(L),V=a(156),P=a.n(V),B=a(298),G=a(121),U=a.n(G),F=a(299),z=a(37),H=Object(S.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerContainer:{overflow:"auto"},content:{flexGrow:1,padding:e.spacing(3)},section1:{margin:e.spacing(2,1)},update_available_button:{color:"primary",borderColor:"primary",variant:"outlined"},no_update_available_button:{visibility:"hidden"}}})),q=function(e){switch(e.index){case 0:return Object(O.jsx)(P.a,{});case 1:return Object(O.jsx)(M.a,{});default:return Object(O.jsx)(W.a,{})}},J=function(e){return Object(O.jsx)(w.a,{children:e.isConnected?Object(O.jsxs)(y.a,{children:[" ",Object(O.jsx)(U.a,{style:{fontSize:16,color:D.a[500]}})," ","Connected"," "]}):Object(O.jsxs)(y.a,{children:[" ",Object(O.jsx)(U.a,{style:{fontSize:16,color:k.a[500]},children:" "})," ","Not Connected"," "]})})};function K(){window.open("https://github.com/sensiml/open-gateway/releases","_blank")}var Y=Object(z.b)((function(e){return{localVersion:e.versionData.localVersion,cloudVersion:e.versionData.cloudVersion,updateAvailable:e.versionData.updateAvailable}}))((function(e){var t=H();console.log(e);return Object(O.jsxs)(T.a,{className:t.drawer,variant:"permanent",classes:{paper:t.drawerPaper},children:[Object(O.jsx)(v.a,{}),Object(O.jsx)("div",{className:t.drawerContainer,children:Object(O.jsxs)(I.a,{children:[["Home","Test Mode"].map((function(t,a){return Object(O.jsxs)(R.a,{button:!0,onClick:(n=a,function(t){e.onChange(n)}),children:[Object(O.jsx)(N.a,{children:Object(O.jsx)(q,{index:a,children:" "})}),Object(O.jsx)(E.a,{primary:t})]},t);var n})),Object(O.jsx)("div",{className:t.section1,children:Object(O.jsx)(B.a,{})}),Object(O.jsx)(R.a,{children:Object(O.jsx)(y.a,{color:"primary",children:"Device Status"})}),Object(O.jsx)(R.a,{children:Object(O.jsx)(J,{text:"Device",isConnected:e.isConnected})}),Object(O.jsx)(R.a,{children:Object(O.jsx)(y.a,{color:"primary",children:"Video Status"})}),Object(O.jsx)(R.a,{children:Object(O.jsx)(J,{text:"Video",isConnected:e.isCameraConnected})}),Object(O.jsx)(R.a,{children:Object(O.jsx)(y.a,{color:"primary",children:"Version"})}),Object(O.jsx)(R.a,{children:Object(O.jsx)(y.a,{color:"black",children:e.localVersion})}),Object(O.jsx)(R.a,{children:Object(O.jsxs)(_.a,{"aria-multiline":!0,startIcon:Object(O.jsx)(F.a,{}),onClick:K,className:e.updateAvailable?t.update_available_button:t.no_update_available_button,children:["Update Available: ",e.cloudVersion]})})]})})]})})),Q=a(22),X=function(){return Object(S.a)((function(e){return{root:{display:"flex"},toolbar:Object(Q.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar),content:{flexGrow:1,width:"100%",padding:e.spacing(5,5,5,35),justifyContent:"flex-end"}}}))()},Z=a(304),$=a(305),ee=a(76),te=a(253),ae=a(250),ne=a(308),ce=a(309),re=a(123),se=a(21),ie=a.n(se),oe=Object(S.a)({root:{minWidth:275},bullet:{transform:"scale(1.0)"},title:{fontSize:20,backgroundColor:"#e0e0e0"},pos:{marginBottom:2,marginTop:2}}),le=function(e){var t=oe();return Object(O.jsxs)(w.a,{item:!0,xs:e.xs,children:[Object(O.jsx)(y.a,{align:"center",className:t.title,color:"textPrimary",children:e.name}),e.list?Object(O.jsx)("div",{className:t.bullet,children:Object(O.jsx)(I.a,{dense:!0,children:e.value.split(",").map((function(e){return Object(O.jsx)(R.a,{children:Object(O.jsx)(E.a,{align:"center",primary:e})})}))})}):Object(O.jsx)(y.a,{align:"center",className:t.pos,color:"textSecondary",children:e.value})]})},de=function(e){return Object(O.jsxs)(w.a,{container:!0,rows:!0,spacing:4,children:[Object(O.jsxs)(w.a,{item:!0,xs:12,container:!0,rows:!0,spacing:2,children:[Object(O.jsx)(le,{name:"Mode",xs:"6",value:e.config.mode}),Object(O.jsx)(le,{name:"Source",xs:"6",value:e.config.source})]}),Object(O.jsxs)(w.a,{item:!0,xs:12,container:!0,rows:!0,spacing:2,children:[Object(O.jsx)(le,{name:"Device ID",xs:6,value:e.config.device_id}),"data_capture"===e.config.mode?Object(O.jsx)(le,{xs:"6",name:"Sample Rate",value:e.config.sample_rate}):null]}),Object(O.jsx)(w.a,{item:!0,xs:12,children:"data_capture"===e.config.mode?Object(O.jsx)(le,{name:"Sensor Columns",value:e.config.column_location,list:!0}):null})]})},ue=a(300),je=a(303),be=a(301),pe=a(104),he=a(302),me=Object(S.a)((function(e){return{root:{display:"flex"},formControl:{margin:e.spacing(3),minWidth:600},button:{margin:e.spacing(1,1,0,0)},section1:{margin:e.spacing(1,1)}}}));function Oe(e){var t=c.a.useState(!1),a=Object(x.a)(t,2),n=a[0],r=a[1],s=c.a.useState(!1),i=Object(x.a)(s,2),o=(i[0],i[1]),l=c.a.useState([]),d=Object(x.a)(l,2),u=d[0],j=d[1],b=c.a.useState(""),p=Object(x.a)(b,2),h=(p[0],p[1]),m=c.a.useState(!1),f=Object(x.a)(m,2),g=(f[0],f[1],me()),v=c.a.useState("Scanning"),y=Object(x.a)(v,2),S=y[0],C=y[1],w=function(){r(!1)},D=function(){C("Scanning for "+e.source+" Devices...."),o(!0),ie.a.post("".concat("/","scan"),{source:e.source.toLowerCase()}).then((function(e){console.log(e.data),o(!1),j(e.data),C("Scanning complete")})).catch((function(e){o(!1),e.response?(h(e.response.data.detail.join(", ")),console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers)):e.request?console.log(e.request):console.log("Error",e.detail)}))};return Object(O.jsxs)("div",{children:[Object(O.jsxs)(_.a,{variant:"outlined",color:"primary",disabled:e.configuring,fullWidth:!0,onClick:function(e){j([]),r(!0),e.preventDefault(),D()},className:g.button,children:["Scan for ",e.source," Devices"]}),Object(O.jsxs)(ue.a,{open:n,onClose:w,fullWidth:"sm",maxWidth:"sm",children:[Object(O.jsxs)(be.a,{children:[Object(O.jsx)(he.a,{children:S}),Object(O.jsx)("div",{style:{height:600,width:"100%"},children:Object(O.jsx)(pe.a,{rows:u,columns:[{field:"id",headerName:"ID",width:0},{field:"device_id",headerName:"Device ID",width:240},{field:"name",headerName:"Name",width:240}],onRowClick:e.handleRowSelection})})]}),Object(O.jsx)(je.a,{children:Object(O.jsx)(_.a,{onClick:w,color:"primary",autoFocus:!0,children:"select"})})]})]})}var fe=a(49),xe=a.n(fe),ge=a(307),ve=a(111),ye=a(89),Se=a(54),Ce=a(251),we=a(126),_e=a(77),De=a(160),ke=a.n(De),Te=function(e){var t=e.cameraKey,a=e.classes,n=e.isCameraConnected;return Object(O.jsx)(ge.a,{className:a.cameraViewWrapper,children:n?Object(O.jsx)("img",{src:"http://localhost:5555/stream-video?".concat(t),alt:"Camera"}):"Video Source is not connected"})},Ie=Object(S.a)((function(e){return{root:{display:"flex"},details:{display:"flex",flexDirection:"column"},content:{flex:"1 0 auto"},controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)},section1:{margin:e.spacing(2,0,3,0)},section2:{margin:e.spacing(2),textAlign:"center"},divWrapper:{margin:e.spacing(3),padding:e.spacing(2,2,2,2),maxWidth:800,minHeight:800},selectWrapper:{height:"3.25rem"},selectSource:{width:"100%"},selectLoading:{lineHeight:3.25},cameraViewWrapper:{minHeight:"480px",minWidth:"640px",display:"flex",alignItems:"center",justifyContent:"center"}}})),Re=function(e,t,a,n,c){console.log(e),ie.a.post("".concat("/","config-video"),{camera_index:c,event_type:e}).then((function(c){console.log(c.data),"camera-on"===e&&(t(!0),a(!0),n(Math.random().toString(36).substring(7)),console.log("caera event"),console.log(e)),"camera-off"===e&&(t(!1),a(!1),console.log("caera event"),console.log(e))}))},Ne=function(e){var t=Ie(),a=c.a.useState(!1),r=Object(x.a)(a,2),s=(r[0],r[1]),i=c.a.useState(""),d=Object(x.a)(i,2),u=d[0],j=d[1],b=c.a.useState([]),p=Object(x.a)(b,2),h=p[0],m=p[1],f=c.a.useState(-2),g=Object(x.a)(f,2),v=g[0],S=g[1],C=c.a.useState(!1),D=Object(x.a)(C,2),k=D[0],T=D[1],I=c.a.useState(""),R=Object(x.a)(I,2),N=R[0],E=R[1],A=function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return E(""),T(!0),e.prev=2,e.next=5,ie.a.get("".concat("/","scan-video"),{});case 5:t=e.sent,a=t.data.video_sources,!xe.a.isEmpty(a)&&xe.a.isArray(a)&&(n=a.find((function(e){return 0===e.index})),m(a),S(n.index)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),E("Failed to load video sources, please, try again");case 13:T(!1);case 14:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){A()}),[]);var M=Object(n.useCallback)((function(){var e,t="Camera";return!xe.a.isEmpty(h)&&xe.a.isArray(h)&&(null===(e=h.find((function(e){return e.index===v})))||void 0===e?void 0:e.name)||t}),[v]);return Object(O.jsxs)("div",{children:[Object(O.jsx)("div",{className:t.section1,children:Object(O.jsx)(y.a,{component:"h3",variant:"h3",color:"secondary",children:"Video Source"})}),Object(O.jsx)("div",{className:t.section1,children:Object(O.jsx)(B.a,{variant:"middle"})}),Object(O.jsx)(Te,{classes:t,cameraKey:u,isCameraConnected:e.isCameraConnected}),Object(O.jsx)("div",{className:t.section2,children:Object(O.jsx)(y.a,{variant:"subtitle1",color:"textSecondary"})}),Object(O.jsx)("div",{className:t.details,children:Object(O.jsxs)(w.a,{container:!0,rows:!0,spacing:2,children:[Object(O.jsx)(w.a,{item:!0,xs:12,children:Object(O.jsx)(ge.a,{className:t.selectWrapper,display:"flex",alignItems:"center",justifyContent:"center",children:N?Object(O.jsxs)(y.a,{color:"error",children:[" ",N," "]}):k?Object(O.jsx)(ge.a,{className:t.selectLoading,children:"Loading..."}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)(ee.a,{className:t.selectSource,variant:"standard",sx:{m:1,minWidth:120},children:[Object(O.jsx)(ve.a,{id:"video_sources_select_label",children:"Video Source"}),Object(O.jsx)(ye.a,{labelId:"video_sources_select_label",id:"video_sources_select",value:v,onChange:function(e){S(e.target.value)},label:"Video source",disabled:!1!==e.isCameraConnected,children:h.map((function(e){return Object(O.jsx)(Se.a,{value:e.index,children:e.name},"source_select_".concat(e.index))}))}),!1!==e.isCameraConnected?Object(O.jsxs)(Ce.a,{id:"my-helper-text",children:["To change souce, first disconnect ",M()]}):null]}),Object(O.jsx)(we.a,{title:"Reload video sources",children:Object(O.jsx)(_e.a,{"aria-label":"delete",size:"large",color:"primary",disabled:!1!==e.isCameraConnected,onClick:function(){A()},children:Object(O.jsx)(ke.a,{fontSize:"inherit"})})})]})})}),Object(O.jsx)(w.a,{item:!0,xs:12,children:!1===e.isCameraConnected?Object(O.jsxs)(_.a,{"aria-label":"Start Camera",variant:"contained",color:"primary",fullWidth:!0,disabled:Boolean(v<-1),onClick:function(){Re("camera-on",s,e.setIsCameraConnected,j,v)},children:["Connect to ",M()]}):Object(O.jsxs)(_.a,{"aria-label":"Stop Camera",color:"primary",variant:"contained",fullWidth:!0,onClick:function(){Re("camera-off",s,e.setIsCameraConnected,j,v)},children:["Disconnect ",M()]})})]})})]})},Ee=Object(S.a)((function(e){return{root:{display:"flex"},formControl:{margin:e.spacing(3),minWidth:600},divWrapper:{margin:e.spacing(3),padding:e.spacing(2,2,2,2),maxWidth:700,minWidth:600},button:{margin:e.spacing(1,1,0,0)},section1:{margin:e.spacing(2,0,1,0)}}})),Ae=function(e){var t=Ee(),a=c.a.useState(e.streamingSource?e.streamingSource:"SERIAL"),r=Object(x.a)(a,2),s=r[0],i=r[1],o=c.a.useState("recognition"===e.streamingMode?"RECOGNITION":"DATA_CAPTURE"),l=Object(x.a)(o,2),d=l[0],u=l[1],j=c.a.useState(e.deviceID),b=Object(x.a)(j,2),p=b[0],h=b[1],m=c.a.useState(!1),f=Object(x.a)(m,2),g=f[0],v=f[1],S=c.a.useState(""),C=Object(x.a)(S,2),D=C[0],k=C[1],T=c.a.useState(!1),I=Object(x.a)(T,2),R=I[0],N=I[1];function E(t){t.mode&&e.setStreamingMode(t.mode),e.setIsConnected(t.streaming),e.setColumns(Object.keys(t.column_location).sort()),e.setStreamingSource(t.source),e.setDeviceID(t.device_id),e.setIsCameraConnected(t.camera_on),e.setBaudRate(t.baud_rate),t.column_location="column_location"in t?Object.keys(t.column_location).sort().join(", "):[],e.setConfig(t)}return Object(n.useEffect)((function(){h(e.deviceID),i(e.streamingSource),u(e.streamingMode.toUpperCase())}),[e.deviceID,e.streamingMode]),Object(O.jsxs)(w.a,{container:!0,columns:!0,children:[Object(O.jsx)(w.a,{item:!0,children:Object(O.jsx)(Z.a,{className:t.divWrapper,children:Object(O.jsxs)($.a,{children:[Object(O.jsx)("div",{className:t.section1,children:Object(O.jsx)(y.a,{component:"h3",variant:"h3",color:"secondary",children:"Device Source"})}),Object(O.jsx)("div",{className:t.section1,children:Object(O.jsx)(B.a,{variant:"middle"})}),e.isConnected?Object(O.jsxs)(c.a.Fragment,{children:[Object(O.jsx)(de,{setStreamingMode:e.setStreamingMode,setColumns:e.setColumns,setStreamingSource:e.setStreamingSource,setDeviceID:e.setDeviceID,setIsConnected:e.setIsConnected,isConnected:e.isConnected,setIsCameraConnected:e.setIsCameraConnected,isCameraConnected:e.isCameraConnected,config:e.config}),Object(O.jsx)(_.a,{type:"submit",variant:"contained",color:"primary",disabled:R,fullWidth:!0,className:t.button,onClick:function(e){ie.a.get("".concat("/","disconnect")).then((function(e){console.log(e.data),E(e.data)}))},children:"Disconnect Device"})]}):Object(O.jsx)(c.a.Fragment,{children:Object(O.jsx)("form",{onSubmit:function(t){if(N(!0),t.preventDefault(),""===p)return k("Must Set DeviceID"),void N(!1);console.log(s),console.log(p);var a={device_id:p,source:s.toLowerCase(),mode:d};"SERIAL"===s&&(a.baud_rate=e.baudRate),ie.a.post("".concat("/","config"),a).then((function(e){E(e.data),!1===e.data.streaming?k("Error starting device, check the logs in the terminal for details for additional details"):k("Device Connected"),N(!1)})).catch((function(e){N(!1),e.response?(k(e.response.data.detail.join(", ")),console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers)):e.request?console.log(e.request):(console.log("Error",e.detail),k(e.response.data.detail.join(", ")))}))},children:Object(O.jsxs)(ee.a,{component:"fieldset",disabled:R||e.isConnected,error:g,className:t.formControl,children:[Object(O.jsxs)("div",{children:[Object(O.jsx)(ae.a,{component:"legend",children:"Device Mode:"}),Object(O.jsxs)(ce.a,{"aria-label":"mode",name:"Streaming Source",value:d,onChange:function(e){console.log("handle mode"),u(e.target.value)},row:!0,children:[Object(O.jsx)(te.a,{value:"DATA_CAPTURE",control:Object(O.jsx)(ne.a,{}),label:"Data Capture"}),Object(O.jsx)(te.a,{value:"RECOGNITION",control:Object(O.jsx)(ne.a,{}),label:"Recognition"})]})]}),Object(O.jsx)("div",{className:t.section1}),Object(O.jsxs)("div",{children:[Object(O.jsx)(ae.a,{children:"Connection Type"}),Object(O.jsxs)(ce.a,{"aria-label":"source",value:s,onChange:function(e){console.log("handle radio"),i(e.target.value)},row:!0,children:[Object(O.jsx)(te.a,{value:"SERIAL",control:Object(O.jsx)(ne.a,{}),label:"Serial"}),Object(O.jsx)(te.a,{value:"BLE",control:Object(O.jsx)(ne.a,{}),label:"BLE"}),Object(O.jsx)(te.a,{value:"TCPIP",control:Object(O.jsx)(ne.a,{}),label:"TCP/IP"}),Object(O.jsx)(te.a,{value:"TEST",control:Object(O.jsx)(ne.a,{}),label:"Test"})]})]}),Object(O.jsx)(Oe,{source:s,handleRowSelection:function(e){console.log(e.row.device_id),h(e.row.device_id)},configuring:R}),Object(O.jsx)("div",{className:t.section1}),Object(O.jsxs)("div",{children:[Object(O.jsx)(ae.a,{component:"legend",children:"Device ID:"}),Object(O.jsx)(re.a,{id:"outlined-basic",variant:"outlined",value:p,onChange:function(e){console.log("handle device id"),h(e.target.value),k(" "),v(!1)},fullWidth:!0})]}),Object(O.jsx)("div",{className:t.section1}),"SERIAL"===s?Object(O.jsxs)("div",{children:[Object(O.jsx)(ae.a,{component:"legend",children:"Baud Rate:"}),Object(O.jsx)(re.a,{id:"outlined-basic",variant:"outlined",value:e.baudRate,onChange:function(t){console.log("handle radio"),e.setBaudRate(t.target.value)},fullWidth:!0})]}):Object(O.jsx)("div",{}),Object(O.jsx)("div",{className:t.section1}),Object(O.jsx)("div",{children:Object(O.jsx)(w.a,{container:!0,columns:!0,spacing:2,children:Object(O.jsx)(w.a,{item:!0,xs:12,children:Object(O.jsx)(_.a,{type:"submit",variant:"contained",color:"primary",disabled:R,fullWidth:!0,className:t.button,children:"Connect to Device"})})})}),Object(O.jsx)("div",{className:t.section1}),Object(O.jsxs)(y.a,{children:[" ",D]})]})})})]})})}),Object(O.jsx)(w.a,{item:!0,children:Object(O.jsx)(Z.a,{className:t.divWrapper,children:Object(O.jsx)($.a,{children:Object(O.jsx)(Ne,{setIsCameraConnected:e.setIsCameraConnected,isCameraConnected:e.isCameraConnected})})})})]})},Me=a(74),Le=a(254),We="SET_GLOBAL_LOADER",Ve="FETCH_DATA_ERROR_MSG",Pe="SET_DATA_ERROR_MSG",Be="START_STREAM_SENSOR_SAGA",Ge="STOP_STREAM_SENSOR_SAGA",Ue="SET_IS_STREAMING_SENSOR",Fe="SET_IS_STREAMING_SENSOR_RECORDING",ze="SET_STREAM_SENSOR_DATA_RESET",He="SET_CHUNK_SENSOR_DATA_SAGA",qe="SET_STREAM_SENSOR_DATA",Je="SET_STREAM_SENSOR_RECORD_DATA",Ke="FETCH_CLASS_MAP_IMAGES",Ye="SET_CLASS_MAP_IMAGES",Qe="UPDATE_CLOUD_VERSION",Xe="UPDATE_LOCAL_VERSION",Ze="UPDATE_AVAILABLE",$e=a(161),et=a.n($e),tt=function(e){var t=e.sensorData,a=e.title,c=Object(n.useState)(0),r=Object(x.a)(c,2),s=r[0],i=r[1];return Object(n.useEffect)((function(){i(s+1),t&&t.length&&t[0].x&&t[0].x.length}),[t]),Object(O.jsx)(et.a,{data:t,revision:s,style:{width:"100%",height:"100%",opacity:"1"},layout:{title:a,visible:!1,autosize:!0,margin:{l:50,r:50,b:100,t:100,pad:4},xaxis:{autorange:!0},yaxis:{autorange:!0}}})},at=Object(S.a)((function(e){return{cardWrapper:{padding:e.spacing(2)},dataWrapper:{padding:e.spacing(2)},chartWrapper:{width:"100%",margin:e.spacing(1)},buttonWrapper:{display:"flex",marginTop:e.spacing(2)},button:{marginLeft:e.spacing(2)},zeroOpacity:{opacity:"0"}}})),nt=function(e){var t,a=e.columns,c=at(),r=Object(z.c)(),s=Object(n.useState)(!1),i=Object(x.a)(s,2),o=i[0],l=i[1],d=Object(z.d)((function(e){return e.stream})),u=d.isStreamingSensor,j=(d.isStreamingSensorRecording,Object(z.d)((t=a,function(e){var a=e.sensorData.sensorSimpleData,n=t.map((function(e){return{x:[],y:[],type:"scatter",mode:"lines",name:e}}));return a.forEach((function(e,a){n[a%t.length].x.push(Math.floor(a/t.length)),n[a%t.length].y.push(e)})),n}))),b=Object(n.useCallback)((function(){return r({type:Be,payload:{countSamples:1e3*(a&&(null===a||void 0===a?void 0:a.length)||1),dataType:e.dataType}})}),[r]),p=Object(n.useCallback)((function(){return r({type:Ge})}),[r]),h=Object(n.useCallback)((function(){return r({type:ze,payload:[]})}),[r]);return Object(n.useEffect)((function(){!e.isConnected&&u&&(p(),h()),e.isConnected&&!u&&b()}),[]),Object(O.jsx)(Z.a,{children:Object(O.jsxs)($.a,{children:[Object(O.jsx)(y.a,{component:"h3",variant:"h3",color:"secondary",children:"Test Mode: Data Capture"}),Object(O.jsxs)(ge.a,{className:c.dataWrapper,children:[Object(O.jsxs)(ge.a,{className:c.chartWrapper,children:[Object(O.jsxs)(ge.a,{className:!u&&c.zeroOpacity,children:[Object(O.jsx)(Le.a,{checked:o,onChange:function(){l(!o)},inputProps:{"aria-label":"secondary checkbox"}})," ","Split charts"]}),j&&j.length&&o?j.map((function(e){return Object(O.jsx)(tt,{title:e.name,sensorData:[e],isStreamingSensor:u})})):Object(O.jsx)(tt,{sensorData:j,isStreamingSensor:u})]}),Object(O.jsx)(ge.a,{className:c.buttonWrapper,children:Object(O.jsx)(_.a,{variant:"contained",color:"primary",className:c.button,onClick:function(){return console.log("streaming",u),void(u?p():(h(),b()))},children:u?"Pause":"Resume"})})]})]})})},ct=a(24),rt=a(310);var st=function(e){var t=new Date,a=c.a.useState(t),r=Object(x.a)(a,2),s=r[0],i=r[1],o=c.a.useState(!1),l=Object(x.a)(o,2),d=l[0],u=l[1];function j(t){var a,n,c=new Date;a=t,n=c,Math.abs(n-a)/1e3>e.delay&&(u(!0),e.setLastValue("Idle"))}return Object(n.useEffect)((function(){var e=new Date;i(e),u(!1)}),[e.data]),c.a.useEffect((function(){if(!d){var e=setInterval((function(){j(s)}),1e3);return function(){clearInterval(e)}}}),[s,d]),Object(O.jsx)(O.Fragment,{children:d?Object(O.jsx)(y.a,{align:"center",variant:"h1",component:"h2",children:"IDLE"}):Object(O.jsx)(y.a,{align:"center",variant:"h1",component:"h2",children:function(t,a){var n="";if(0===t.length)return n="No Results",e.setLastValue(n),n;a>t.length&&(a=t.length-1);for(var c={},r=t.length-a;r<t.length;r++)t[r].Classification in c?c[t[r].Classification]+=1:c[t[r].Classification]=1;for(var s=0,i=0,o=0,l=Object.entries(c);o<l.length;o++){var d=Object(x.a)(l[o],2),u=d[0],j=d[1];j>i&&(i=j,s=u)}return i<a/2?(n="UNC",e.setLastValue(n),n):(n=s,e.setLastValue(n),n)}(e.data,e.filter_length)})})},it=function(e){var t=Object(n.useState)(""),a=Object(x.a)(t,2),c=a[0],r=a[1];return Object(O.jsxs)(ge.a,{children:[Object(O.jsxs)(_.a,{variant:"contained",component:"label",children:["Upload Class Map JSON",Object(O.jsx)("input",{type:"file",hidden:!0,onChange:function(e){var t=e.target.files[0],a=new FileReader;a.readAsText(t),a.onload=function(){console.log(a.result);var e={};try{e=JSON.parse(a.result),ie.a.post("".concat("/","config-model-json"),e).then((function(e){console.log(e.data),r("")})).catch((function(e){r("upload failed"),console.log(e)}))}catch(t){}},a.onerror=function(){console.log(a.error)}}})]}),Object(O.jsxs)(y.a,{children:[" ",c]})]})},ot=function(e){var t=Object(n.useState)(""),a=Object(x.a)(t,2),c=a[0],r=a[1];return Object(O.jsxs)(ge.a,{children:[Object(O.jsxs)(_.a,{variant:"contained",component:"label",children:["Upload Class Images JSON",Object(O.jsx)("input",{type:"file",hidden:!0,onChange:function(e){var t=e.target.files[0],a=new FileReader;a.readAsText(t),a.onload=function(){console.log(a.result);var e={};try{e=JSON.parse(a.result),ie.a.post("".concat("/","config-class-map-images-json"),e).then((function(e){console.log(e.data),r("")})).catch((function(e){r("upload failed"),console.log(e)}))}catch(t){}},a.onerror=function(){console.log(a.error)}}})]}),Object(O.jsxs)(y.a,{children:[" ",c]})]})},lt=0,dt=Object(S.a)((function(e){return{controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)},root:{width:"800px"},sliderroot:{width:"100%"},sliderinput:{width:42},section1:{margin:e.spacing(3,2)},section2:{margin:e.spacing(2),textAlign:"center"},cardBottom:{marginTop:e.spacing(2),marginBottom:e.spacing(2)}}}));var ut=function(e,t,a,n,c){lt=0,a([]),n(!0),fetch(t,{method:"GET"}).then((function(e){var t=e.body.getReader();c(t);var r=new ReadableStream({start:function(e){!function c(){t.read().then((function(t){var r=t.done,s=t.value;if(r)return n(!1),void e.close();for(var i=function(e){var t=String.fromCharCode.apply(null,e).split("\n");return t.pop(),t.map((function(e){return JSON.parse(e)}))}(s),o=function(e){console.log(i[e]),i[e].id=lt,lt+=1,a((function(t){return[].concat(Object(ct.a)(t),[i[e]])}))},l=0;l<i.length;l++)o(l);c()}))}()}});return new Response(r,{headers:{"Content-Type":"text/html"}})}))};var jt=function(e){var t=c.a.useState([]),a=Object(x.a)(t,2),r=a[0],s=a[1],i=c.a.useState(!1),o=Object(x.a)(i,2),l=o[0],d=o[1],u=c.a.useState(),j=Object(x.a)(u,2),b=j[0],p=j[1],h=c.a.useState(5),m=Object(x.a)(h,2),f=m[0],g=m[1],v=c.a.useState(1),S=Object(x.a)(v,2),C=S[0],D=S[1],k=dt();return Object(n.useEffect)((function(){ut(0,"".concat("/","results"),s,d,p)}),[]),function(e){var t=Object(n.useRef)(e);Object(n.useEffect)((function(){t.current=e}),[e]),Object(n.useEffect)((function(){return function(){t.current.cancel()}}),[])}(b),Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(Z.a,{children:Object(O.jsxs)($.a,{children:[Object(O.jsxs)("div",{className:k.section1,children:[Object(O.jsx)(w.a,{item:!0,xs:12,children:Object(O.jsx)(y.a,{align:"center",component:"h2",variant:"h2",color:"secondary",children:"Test Mode: Recognition"})}),Object(O.jsx)("div",{className:k.section1,children:Object(O.jsx)(B.a,{variant:"middle"})})]}),Object(O.jsx)(w.a,{item:!0,alignContent:"center",xs:12,children:Object(O.jsx)(st,{data:r,filter_length:C,setLastValue:e.setLastValue,delay:f})}),Object(O.jsx)("div",{className:k.section1,children:Object(O.jsx)(B.a,{variant:"middle"})}),Object(O.jsx)("div",{className:k.section1,children:Object(O.jsx)("div",{style:{height:600,width:"100%"},children:Object(O.jsx)(pe.a,{rows:r,columns:[{field:"id",headerName:"ID",width:70},{field:"source",headerName:"Device ID",width:240},{field:"ModelNumber",headerName:"Model ID",width:240},{field:"Classification",headerName:"Classification",width:240}],pageSize:15,sortModel:[{field:"id",sort:"desc"}]})})}),l?Object(O.jsx)(_.a,{"aria-label":"disconnect",color:"primary",variant:"contained",fullWidth:!0,onClick:function(){!function(e,t,a){t.cancel(),a(!1)}(0,b,d)},children:"Pause"}):Object(O.jsx)(_.a,{"aria-label":"disconnect",color:"primary",variant:"contained",fullWidth:!0,onClick:function(){ut(0,"".concat("/","results"),s,d,p)},children:"Resume"})]})}),Object(O.jsx)(Z.a,{className:k.cardBottom,children:Object(O.jsxs)($.a,{children:[Object(O.jsx)(y.a,{align:"left",color:"primary",component:"h5",variant:"h5",children:"Post Processing"}),Object(O.jsx)("div",{className:k.section1,children:Object(O.jsx)(B.a,{variant:"middle"})}),Object(O.jsxs)(w.a,{container:!0,spacing:4,rows:!0,alignItems:"center",children:[Object(O.jsx)(w.a,{item:!0,xs:4,children:Object(O.jsx)(y.a,{align:"center",component:"h6",variant:"h6",children:"Majority Vote Buffer"})}),Object(O.jsx)(w.a,{item:!0,xs:6,children:Object(O.jsx)("div",{className:k.sliderroot,children:Object(O.jsx)(rt.a,{value:"number"===typeof C?C:1,onChange:function(e,t){D(t)},"aria-labelledby":"input-slider",min:1,max:10})})}),Object(O.jsx)(w.a,{item:!0,xs:1,children:Object(O.jsx)(y.a,{align:"center",component:"h6",variant:"h6",children:C})})]}),Object(O.jsxs)(w.a,{container:!0,spacing:4,rows:!0,alignItems:"center",children:[Object(O.jsx)(w.a,{item:!0,xs:4,children:Object(O.jsx)(y.a,{align:"center",component:"h6",variant:"h6",children:"Idle Delay"})}),Object(O.jsx)(w.a,{item:!0,xs:6,children:Object(O.jsx)("div",{className:k.sliderroot,children:Object(O.jsx)(rt.a,{value:"number"===typeof f?f:5,onChange:function(e,t){g(t)},"aria-labelledby":"input-slider",min:1,max:10})})}),Object(O.jsx)(w.a,{item:!0,xs:1,children:Object(O.jsx)(y.a,{align:"center",component:"h6",variant:"h6",children:f})})]}),Object(O.jsx)("div",{className:k.section1,children:Object(O.jsx)(B.a,{variant:"middle"})}),Object(O.jsx)(y.a,{align:"left",color:"primary",component:"h5",variant:"h5",children:"Mapping"}),Object(O.jsx)("div",{className:k.section1,children:Object(O.jsx)(B.a,{variant:"middle"})}),Object(O.jsxs)(w.a,{container:!0,spacing:2,children:[Object(O.jsx)(w.a,{item:!0,children:Object(O.jsx)(it,{})}),Object(O.jsx)(w.a,{item:!0,children:Object(O.jsx)(ot,{})})]})]})})]})},bt=Object(S.a)((function(e){return{root:{display:"flex"},details:{display:"flex",flexDirection:"column"},content:{flex:"1 0 auto"},controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)},section1:{margin:e.spacing(3,2)},section2:{margin:e.spacing(2),textAlign:"center"}}})),pt=function(e){var t=bt(),a=c.a.useState(e.isRecording),n=Object(x.a)(a,2),r=n[0],s=n[1],i=c.a.useState("filename"),o=Object(x.a)(i,2),l=o[0],d=o[1],u=c.a.useState(!1),j=Object(x.a)(u,2),b=j[0],p=j[1];console.log(e.isCameraConnected);var h=function(e,t,a,n){p(!0),console.log(e),""===n&&(n="test"),console.log(n),ie.a.post("".concat("/")+t,{filename:n,event_type:e}).then((function(t){console.log(t.data),"record-start"===e&&(a(!0),console.log(e)),"record-stop"===e&&(a(!1),console.log(e)),p(!1)})).catch((function(e){console.log(e),p(!1)}))};return Object(O.jsx)(Z.a,{children:Object(O.jsxs)($.a,{children:[Object(O.jsx)("div",{className:t.section1,children:Object(O.jsx)(y.a,{component:"h4",variant:"h4",color:"secondary",children:"Record to Gateway"})}),Object(O.jsx)(B.a,{variant:"middle"}),Object(O.jsx)("div",{className:t.section2,children:Object(O.jsx)(y.a,{variant:"subtitle1",color:"textSecondary"})}),Object(O.jsxs)(w.a,{container:!0,columns:!0,spacing:6,children:[Object(O.jsx)(w.a,{item:!0,xs:12,children:Object(O.jsx)(re.a,{id:"outlined-basic",variant:"outlined",value:l,onChange:function(e){d(e.target.value)},fullWidth:!0,disabled:r})}),Object(O.jsx)(w.a,{item:!0,xs:6,children:!1===r?Object(O.jsx)(we.a,{title:"This will record the device sensor data in .csv format to the gateway. If video source is connected, the video source will also be recorded. ","aria-label":"record",children:Object(O.jsx)(_.a,{"aria-label":"Record",variant:"contained",fullWidth:!0,disabled:b,onClick:function(){h("record-start",e.isCameraConnected?"record":"record-device",s,l)},children:"Record"})}):Object(O.jsx)(_.a,{"aria-label":"Stop ",variant:"contained",fullWidth:!0,disabled:b,onClick:function(){h("record-stop",e.isCameraConnected?"record":"record-device",s)},children:"Stop Recording"})}),Object(O.jsx)(w.a,{item:!0,xs:6,children:Object(O.jsx)(we.a,{title:"Download the recorded .csv and .mp4 for this capture from the gateway. A .dcli file will also be generated describing the data. ","aria-label":"record",children:Object(O.jsx)(_.a,{"aria-label":"Download ",variant:"contained",fullWidth:!0,disabled:b,onClick:function(){!function(e,t){console.log("".concat("/","download/")+t),fetch("".concat("/","download/")+t,{method:"GET",headers:{"Content-Type":"application/zip"}}).then((function(e){return e.blob()})).then((function(e){var a=window.URL.createObjectURL(new Blob([e])),n=document.createElement("a");n.href=a,n.setAttribute("download",t+".zip"),document.body.appendChild(n),n.click(),n.parentNode.removeChild(n)}))}(0,l)},children:"Download"})})})]})]})})},ht="/",mt="https://sensiml.cloud/",Ot=Object(S.a)((function(e){return{root:{display:"flex"},details:{display:"flex",flexDirection:"column"},content:{flex:"1 0 auto"},controls:{display:"flex",alignItems:"center"},classImageWrapper:{display:"flex",justifyContent:"center",alignItems:"center",padding:"1rem",marginBottom:"1rem",minHeight:"450px"},classImage:{width:"90%"},section1:{margin:e.spacing(3,2)}}})),ft=function(e){var t,a=Ot(),c=Object(n.useState)(""),r=Object(x.a)(c,2),s=r[0],i=r[1],o=Object(z.d)((t=s,function(e){var a=e.classes.classMapImages,n=xe.a.toString(t);if(a&&n){var c=a[n];return c?(console.log("imgPath",c),"".concat("/").concat(c)):""}return""}));return Object(O.jsx)(w.a,{container:!0,rows:!0,spacing:6,children:"recognition"!==e.streamingMode?Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(w.a,{item:!0,lg:8,md:12,children:Object(O.jsx)(nt,{columns:e.columns,isConnected:e.isConnected,dataType:e.dataType})}),Object(O.jsx)(w.a,{item:!0,md:12,lg:4,children:Object(O.jsx)(pt,{isCameraConnected:e.isCameraConnected,isRecording:e.isRecording})})]}):Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(w.a,{item:!0,md:12,lg:6,children:Object(O.jsx)(jt,{setLastValue:function(e){i(e||"")}})}),Object(O.jsxs)(w.a,{item:!0,md:12,lg:6,children:[Object(O.jsx)(Me.a,{className:a.imageWrapperCard,children:Object(O.jsx)(ge.a,{className:a.classImageWrapper,children:o?Object(O.jsx)("img",{className:a.classImage,src:o,alt:s}):s?"No Image for ".concat(s):""})}),Object(O.jsx)(pt,{isCameraConnected:e.isCameraConnected,isRecording:e.isRecording})]})]})})},xt=a(306),gt=a(107),vt=function(e){var t=Object(z.c)(),a=c.a.useState(0),r=Object(x.a)(a,2),s=r[0],i=r[1],o=c.a.useState("DATA_CAPTURE"),l=Object(x.a)(o,2),d=l[0],u=l[1],j=c.a.useState(null),b=Object(x.a)(j,2),p=b[0],h=b[1],m=c.a.useState([]),f=Object(x.a)(m,2),g=f[0],v=f[1],y=c.a.useState([]),S=Object(x.a)(y,2),_=S[0],D=S[1],k=c.a.useState(!1),T=Object(x.a)(k,2),I=T[0],R=T[1],N=c.a.useState(!1),E=Object(x.a)(N,2),A=E[0],M=E[1],L=c.a.useState(!1),W=Object(x.a)(L,2),V=W[0],P=(W[1],c.a.useState(null)),B=Object(x.a)(P,2),G=B[0],U=B[1],F=c.a.useState({}),H=Object(x.a)(F,2),q=H[0],J=H[1],K=c.a.useState(null),Q=Object(x.a)(K,2),Z=(Q[0],Q[1],c.a.useState("int16")),$=Object(x.a)(Z,2),ee=$[0],te=$[1],ae=Object(gt.b)(),ne=ae.enqueueSnackbar,ce=(ae.closeSnackbar,Object(z.d)((function(e){return e.stream})).isStreamingSensor),re=Object(z.d)((function(e){return e.errors})).errorDataMsg;function se(e){var t;if(e.mode&&u(e.mode),R(e.streaming),v(Object.keys(e.column_location).sort()),h(null===(t=e.source)||void 0===t?void 0:t.toUpperCase()),D(e.device_id),M(e.camera_on),U(e.baud_rate),"float"===e.data_type)te("float");else te("int16");e.column_location="column_location"in e?Object.keys(e.column_location).sort().join(", "):[],J(e)}var oe=function(e){ce&&(e.preventDefault(),e.returnValue="")},le=Object(n.useCallback)((function(){return t({type:Ge})}),[t]),de=Object(n.useCallback)((function(){return t({type:Ke})}),[t]);Object(n.useEffect)((function(){if(ce)return window.addEventListener("beforeunload",oe),window.addEventListener("unload",le),function(){window.removeEventListener("beforeunload",oe),window.removeEventListener("unload",le),le()}}),[ce]),Object(n.useEffect)((function(){re&&ne(re,{variant:"warning"})}),[re]),Object(n.useEffect)((function(){ie.a.get("".concat("/","config"),{}).then((function(e){se(e.data),console.log(e.data)})),de()}),[s]),Object(n.useLayoutEffect)((function(){ie.a.get("".concat("/","config"),{}).then((function(e){se(e.data)}))}),[]);var ue=X();return Object(O.jsxs)("div",{className:ue.root,children:[Object(O.jsx)(xt.a,{}),Object(O.jsxs)(w.a,{container:!0,direction:"column",justify:"center",alignItems:"center",children:[Object(O.jsx)(C,{}),Object(O.jsx)(Y,{onChange:function(e){s!==e&&i(e)},isConnected:I,isCameraConnected:A}),Object(O.jsxs)("main",{className:ue.content,children:[0===s?Object(O.jsx)(Ae,{streamingMode:d,deviceID:_,setStreamingMode:u,setColumns:v,setStreamingSource:h,setDeviceID:D,setIsConnected:R,isConnected:I,setIsCameraConnected:M,isCameraConnected:A,config:q,setConfig:J,streamingSource:p,baudRate:G,setBaudRate:U}):null,1===s?Object(O.jsx)(ft,{columns:g,streamingMode:d,isConnected:I,isRecording:V,isCameraConnected:A,setIsCameraConnected:M,samplerate:q.samplerate,dataType:ee}):null]})]})]})},yt=a(163),St=a(60),Ct=a(162),wt=a(17),_t=o.a.mark(kt),Dt=o.a.mark(Tt);function kt(e){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(wt.e)({type:Pe,payload:e.payload});case 2:return t.next=4,Object(wt.c)(1e3);case 4:return t.next=6,Object(wt.e)({type:Pe,payload:null});case 6:case"end":return t.stop()}}),_t)}function Tt(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wt.g)(Ve,kt);case 2:case"end":return e.stop()}}),Dt)}var It=a(53),Rt=a(62),Nt=a(86),Et=a(88),At=a(164),Mt=function(e){Object(Nt.a)(a,e);var t=Object(Et.a)(a);function a(e,n){var c;return Object(It.a)(this,a),(c=t.call(this)).detail=500!==e?n.detail:"Server Error. Please, contact support.",c.name=c.constructor.name,c.errorCode=e,c}return a}(Object(At.a)(Error)),Lt=function(){function e(t){Object(It.a)(this,e),this.reader=void 0,this.fetchUrl=t}return Object(Rt.a)(e,[{key:"startStreaming",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getting response"),e.prev=1,e.next=4,fetch(this.fetchUrl);case 4:t=e.sent,e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(1),console.log(e.t0),new Mt(404,{detail:"Failed to fetch API service"});case 11:if(t.ok){e.next=13;break}throw new Mt(t.status,{detail:t.statusText});case 13:console.log("getting reader"),this.reader=t.body.getReader();case 15:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"stopStreaming",value:function(){var e=Object(l.a)(o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.reader&&(this.reader.cancel(),this.reader=void 0);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readStreamToRedux",value:function(){var e=Object(l.a)(o.a.mark((function e(t){var a,n,c,r,s,i=arguments;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a=i.length>1&&void 0!==i[1]?i[1]:0,n=i.length>2&&void 0!==i[2]?i[2]:"int16",console.log("DATA TYPE IS "+n),c="float"===n?Float32Array:Int16Array;case 4:return e.next=7,this.reader.read();case 7:if(r=e.sent,s=r.value,!r.done){e.next=12;break}return e.abrupt("break",15);case 12:Da.dispatch({type:t,payload:{chunk:new c(s.buffer),countSamples:a}}),e.next=4;break;case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Wt=Lt,Vt=void 0,Pt=o.a.mark(Gt),Bt=o.a.mark(Ut);function Gt(e){var t,a,n;return o.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,t=null===e||void 0===e?void 0:e.payload,a=t.countSamples,n=t.dataType,console.log(e.payload),c.next=5,Object(wt.b)([Vt,"startStreaming"]);case 5:return c.next=7,Object(wt.e)({type:Ue,payload:!0});case 7:return c.next=9,Object(wt.b)([Vt,"readStreamToRedux"],He,a,n);case 9:case 17:c.next=21;break;case 11:if(c.prev=11,c.t0=c.catch(0),console.debug(c.t0),!(c.t0 instanceof Mt)){c.next=19;break}return c.next=17,Object(wt.e)({type:Ve,payload:c.t0.detail});case 19:return c.next=21,Object(wt.e)({type:Ve,payload:"Failed to read stream data"});case 21:case"end":return c.stop()}}),Pt,null,[[0,11]])}function Ut(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wt.h)(Be,Gt);case 2:case"end":return e.stop()}}),Bt)}var Ft=o.a.mark(Ht),zt=o.a.mark(qt);function Ht(e){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(wt.b)([Vt,"stopStreaming"]);case 3:return e.next=5,Object(wt.e)({type:Ue,payload:!1});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.debug(e.t0);case 10:case"end":return e.stop()}}),Ft,null,[[0,7]])}function qt(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wt.h)(Ge,Ht);case 2:case"end":return e.stop()}}),zt)}var Jt=o.a.mark(Kt);function Kt(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wt.a)([Object(wt.d)(Ut),Object(wt.d)(qt)]);case 2:case"end":return e.stop()}}),Jt)}var Yt=o.a.mark(Xt),Qt=o.a.mark(Zt);function Xt(e){var t,a,n,c,r,s,i,l,d,u,j,b,p,h;return o.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,t=e.payload,a=t.chunk,n=t.countSamples,c=a&&a.length||0,r=[],o.next=6,Object(wt.f)((function(e){return e.sensorData}));case 6:return s=o.sent,i=s.sensorSimpleData,l=s.sensorRecordedData,o.next=11,Object(wt.f)((function(e){return e.stream}));case 11:if(d=o.sent,u=d.isStreamingSensorRecording,console.log("called",c/12),c>=n)r=Object(ct.a)(a);else if(i.length>=n)for(r=Object(ct.a)(i),j=[0,i.length,0],b=j[0],p=j[1],h=j[2];b<p;)p-b>c?r[b]=i[b+c]:(r[b]=a[h],h++),b++;else r=[].concat(Object(ct.a)(i),Object(ct.a)(a));return o.next=17,Object(wt.e)({type:qe,payload:r});case 17:if(!u){o.next=20;break}return o.next=20,Object(wt.e)({type:Je,payload:[].concat(Object(ct.a)(l),Object(ct.a)(a))});case 20:o.next=25;break;case 22:o.prev=22,o.t0=o.catch(0),console.debug(o.t0);case 25:case"end":return o.stop()}}),Yt,null,[[0,22]])}function Zt(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wt.h)(He,Xt);case 2:case"end":return e.stop()}}),Qt)}var $t=o.a.mark(ea);function ea(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wt.a)([Object(wt.d)(Zt)]);case 2:case"end":return e.stop()}}),$t)}var ta={interceptor_401:null,refreshUrl:"/auth/refresh",init:function(e){ie.a.defaults.baseURL=e},mount401Interceptor:function(){this.interceptor_401=ie.a.interceptors.response.use((function(e){return e}),function(){var e=Object(l.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(401!==t.request.status){e.next=5;break}if(!t.config.url.includes("auth")){e.next=5;break}throw t;case 5:throw t;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},unmount401Interceptor:function(){ie.a.interceptors.response.eject(this.interceptor_401)},setCustomAuthHeader:function(e){ie.a.defaults.headers.common.Authorization=e},setContentType:function(e){ie.a.defaults.headers.contentType=e},removeHeader:function(){ie.a.defaults.headers.common={}},get:function(e){return ie.a.get(e)},post:function(e,t){return ie.a.post(e,t)},put:function(e,t){return ie.a.put(e,t)},delete:function(e){return ie.a.delete(e)},customRequest:function(e){return ie()(e)},customJsonRequest:function(e){return this.setAuthHeader(),this.setContentType("application/json"),ie()(e)}},aa=ta,na=o.a.mark(ra),ca=o.a.mark(sa);function ra(){var e,t;return o.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,aa.get("class-map-images");case 2:return e=a.sent,a.next=5,console.log("classesMapImagesSagas");case 5:if(xe.a.isEmpty(e.data)){a.next=11;break}return a.next=8,xe.a.reduce(e.data,(function(e,t){return e[t.name]=t.img,e}),[{}]);case 8:return t=a.sent,a.next=11,Object(wt.e)({type:Ye,payload:t});case 11:case"end":return a.stop()}}),na)}function sa(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wt.g)(Ke,ra);case 2:case"end":return e.stop()}}),ca)}var ia=o.a.mark(oa);function oa(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(wt.a)([Object(wt.d)(Kt),Object(wt.d)(Tt),Object(wt.d)(ea),Object(wt.d)(sa)]);case 2:case"end":return e.stop()}}),ia)}var la={globalLoader:!1};function da(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:la,t=arguments.length>1?arguments[1]:void 0;return t.type===We?Object(Q.a)(Object(Q.a)({},e),{},{globalLoader:t.payload||!1}):e}var ua={errorDataMsg:null};function ja(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ua,t=arguments.length>1?arguments[1]:void 0;return t.type===Pe?Object(Q.a)(Object(Q.a)({},e),{},{errorDataMsg:t.payload}):e}var ba={isStreamingSensor:!1,isStreamingSensorRecording:!1};function pa(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ba,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Ue:return Object(Q.a)(Object(Q.a)({},e),{},{isStreamingSensor:t.payload});case Fe:return Object(Q.a)(Object(Q.a)({},e),{},{isStreamingSensorRecording:t.payload});default:return e}}var ha={sensorSimpleData:new Int16Array,sensorRecordedData:new Int16Array};function ma(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ha,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ze:return Object(Q.a)(Object(Q.a)({},e),{},{sensorSimpleData:new Int16Array,sensorRecordedData:new Int16Array});case qe:return Object(Q.a)(Object(Q.a)({},e),{},{sensorSimpleData:Object(ct.a)(t.payload)});case Je:return Object(Q.a)(Object(Q.a)({},e),{},{sensorRecordedData:Object(ct.a)(t.payload)});default:return e}}var Oa={classMapImages:{}};function fa(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oa,t=arguments.length>1?arguments[1]:void 0;return t.type===Ye?Object(Q.a)(Object(Q.a)({},e),{},{classMapImages:t.payload}):e}var xa={localVersion:"",cloudVersion:"",updateAvailable:!1};function ga(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:xa,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Qe:return Object(Q.a)(Object(Q.a)({},e),{},{cloudVersion:t.payload});case Ze:return Object(Q.a)(Object(Q.a)({},e),{},{updateAvailable:e.localVersion<e.cloudVersion});case Xe:return Object(Q.a)(Object(Q.a)({},e),{},{localVersion:t.payload});default:return e}}var va=function(){return Object(St.combineReducers)({root:da,errors:ja,stream:pa,sensorData:ma,versionData:ga,classes:fa})},ya=Object(yt.a)(),Sa=[ya],Ca=Ct.composeWithDevTools.apply(void 0,[St.applyMiddleware.apply(void 0,Sa)].concat([])),wa=va(),_a=Object(St.createStore)(wa,Ca);ya.run(oa);var Da=_a;aa.init(ht),Vt=new Wt("".concat(ht,"stream"));var ka=function(e){return Object(n.useEffect)((function(){var t=function(){var t=Object(l.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.versionCheck.checkUpdate();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();t()}),[]),Object(O.jsx)(f,{children:Object(O.jsx)(z.a,{store:Da,children:Object(O.jsx)(gt.a,{anchorOrigin:{horizontal:"right",vertical:"top"},autoHideDuration:2e3,children:Object(O.jsx)(vt,{})})})})},Ta=function(){function e(t,a){Object(It.a)(this,e),this.baseurl=t,this.cloudurl=a,this.localVersion="",this.cloudVersion="",this.updateAvailable=!1}return Object(Rt.a)(e,[{key:"checkUpdate",value:function(){var e=Object(l.a)(o.a.mark((function e(){var t,a,n,c;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ie.a.get("".concat(this.baseurl,"version"));case 3:t=e.sent,e.next=10;break;case 6:throw e.prev=6,e.t0=e.catch(0),console.log(e.t0),new Mt(404,{detail:"Failed to fetch API service"});case 10:if("OK"===t.statusText){e.next=12;break}throw new Mt(a.status,{detail:t.statusText});case 12:return this.localVersion=t.data,Da.dispatch({type:Xe,payload:t.data}),e.prev=14,n="".concat(this.cloudurl,"version/?format=json"),e.next=18,ie.a.get(n,{headers:{"Content-Type":"application/json"}});case 18:a=e.sent,e.next=25;break;case 21:return e.prev=21,e.t1=e.catch(14),console.log(e.t1),e.abrupt("return");case 25:if("OK"===a.statusText){e.next=27;break}return e.abrupt("return");case 27:(c=a.data).SensiML_Open_Gateway_Windows&&(this.cloudVersion=c.SensiML_Open_Gateway_Windows,Da.dispatch({type:Qe,payload:c.SensiML_Open_Gateway_Windows}),Da.dispatch({type:Ze,payload:this.localVersion<this.cloudVersion}));case 29:case"end":return e.stop()}}),e,this,[[0,6],[14,21]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),Ia=new Ta(ht,mt);s.a.render(Object(O.jsx)(ka,{versionCheck:Ia}),document.getElementById("root"))}},[[239,1,2]]]);
//# sourceMappingURL=main.fb92b7f5.chunk.js.map