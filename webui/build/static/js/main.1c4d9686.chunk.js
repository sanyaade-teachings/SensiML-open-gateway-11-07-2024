(this.webpackJsonpwebui=this.webpackJsonpwebui||[]).push([[0],{188:function(e,t,n){},189:function(e,t,n){},222:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n(0),r=n.n(c),o=n(16),s=n.n(o),i=(n(188),n(189),n(271)),l=n(272),d=n(98),u=n(273),j=n(25),b=n(152),h=n(274),p=function(e){var t=Object(j.a)(),n=Object(b.a)({palette:{primary:{light:i.a[600],main:i.a[800],dark:i.a[800],contrastText:t.palette.getContrastText(i.a[800])},accent:{light:l.a[200],main:l.a[500],dark:l.a[800],contrastText:t.palette.getContrastText(l.a[500])},secondary:{light:i.a[600],main:i.a[700],dark:i.a[800],contrastText:t.palette.getContrastText(i.a[600])},secondaryRed:{light:d.a[600],main:d.a[700],dark:d.a[800],contrastText:t.palette.getContrastText(d.a[600])},notSelected:{light:u.a[500],main:u.a[700],dark:u.a[800],contrastText:t.palette.getContrastText(u.a[600])},error:{light:d.a[200],main:d.a[500],dark:d.a[800],contrastText:t.palette.getContrastText(d.a[500])},record:{light:d.a[900],main:d.a[900],dark:d.a[900],contrastText:t.palette.getContrastText(d.a[500])}}});return Object(a.jsx)(h.a,{theme:n,children:e.children})},x=n(8),O=n(276),m=n(278),f=n(79),g=n(78),v=function(){var e=Object(g.a)((function(e){return{navbarDisplayFlex:{display:"flex",justifyContent:"space-between"},navDisplayFlex:{display:"flex-right",justifyContent:"space-between"},linkText:{textDecoration:"none",textTransform:"uppercase",color:"white"},appBar:{zIndex:e.zIndex.drawer+1}}}))();return Object(a.jsx)(O.a,{position:"static",className:e.appBar,children:Object(a.jsx)(m.a,{children:Object(a.jsx)(f.a,{variant:"h6",children:"SensiML Streaming Gateway"})})})},S=n(279),y=n(67),C=n(291),w=n(224),k=n(225),D=n(226),T=n(281),R=n(143),N=n.n(R),_=n(142),E=n.n(_),I=n(110),A=n.n(I),M=n(144),L=n.n(M),W=n(282),G=Object(g.a)((function(e){return{root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+1},drawer:{width:240,flexShrink:0},drawerPaper:{width:240},drawerContainer:{overflow:"auto"},content:{flexGrow:1,padding:e.spacing(3)},section1:{margin:e.spacing(2,1)}}})),z=function(e){switch(e.index){case 0:return Object(a.jsx)(E.a,{});case 1:return Object(a.jsx)(N.a,{});case 3:return Object(a.jsx)(L.a,{});case 4:default:return Object(a.jsx)(A.a,{})}},B=function(e){return Object(a.jsx)(S.a,{children:e.isConnected?Object(a.jsxs)(y.a,{color:"primary",variant:"contained","aria-label":"connected",children:[e.text,": Connected"]}):Object(a.jsxs)(y.a,{variant:"contained","aria-label":"disconnect",disabled:!0,children:[e.text,": Disconnected"]})})},P=function(e){var t=G();return Object(a.jsxs)(C.a,{className:t.drawer,variant:"permanent",classes:{paper:t.drawerPaper},children:[Object(a.jsx)(m.a,{}),Object(a.jsx)("div",{className:t.drawerContainer,children:Object(a.jsxs)(w.a,{children:[["Gateway Status","Test Mode","Record Mode","Configure"].map((function(t,n){return Object(a.jsxs)(k.a,{button:!0,onClick:(c=n,function(t){e.onChange(c)}),children:[Object(a.jsx)(D.a,{children:Object(a.jsx)(z,{index:n,children:" "})}),Object(a.jsx)(T.a,{primary:t})]},t);var c})),Object(a.jsx)("div",{className:t.section1,children:Object(a.jsx)(W.a,{})}),Object(a.jsx)(k.a,{children:Object(a.jsx)(B,{text:"Device",isConnected:e.isConnected})}),Object(a.jsx)(k.a,{children:Object(a.jsx)(B,{text:"Video",isConnected:e.isCameraConnected})})]})})]})},F=n(24),U=function(){return Object(g.a)((function(e){return{root:{display:"flex"},toolbar:Object(F.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1)},e.mixins.toolbar),content:{flexGrow:1,width:"100%",padding:e.spacing(5,5,5,35),justifyContent:"flex-end"}}}))()},q=n(284),V=n(283),H=n(21),J=n.n(H),K=Object(g.a)({root:{minWidth:275},bullet:{transform:"scale(1.0)"},title:{fontSize:20,backgroundColor:"#e0e0e0"},pos:{marginBottom:2,marginTop:2}}),Q=function(e){var t=K();return Object(a.jsx)(S.a,{item:!0,xs:e.xs,children:Object(a.jsx)(V.a,{className:t.root,children:Object(a.jsxs)(q.a,{children:[Object(a.jsx)(f.a,{align:"center",className:t.title,color:"textPrimary",children:e.name}),e.list?Object(a.jsx)("div",{className:t.bullet,children:Object(a.jsx)(w.a,{dense:!0,children:e.value.split(",").map((function(e){return Object(a.jsx)(k.a,{children:Object(a.jsx)(T.a,{align:"center",primary:e})})}))})}):Object(a.jsx)(f.a,{align:"center",className:t.pos,color:"textSecondary",children:e.value})]})})})},X=function(e){return console.log(e),Object(a.jsx)("img",{src:"http://localhost:5555/stream-video?"+e.cameraKey,alt:"Camera Not Started."})},Y=Object(g.a)((function(e){return{root:{display:"flex"},details:{display:"flex",flexDirection:"column"},content:{flex:"1 0 auto"},controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)},section1:{margin:e.spacing(3,2)},section2:{margin:e.spacing(2),textAlign:"center"}}})),Z=function(e,t,n,a){console.log(e),J.a.post("".concat("http://localhost:5555/","config-video"),{camera_index:0,event_type:e}).then((function(c){console.log(c.data),"camera-on"==e&&(t(!0),n(!0),a(Math.random().toString(36).substring(7)),console.log("caera event"),console.log(e)),"camera-off"==e&&(t(!1),n(!1),console.log("caera event"),console.log(e))}))},$=function(e){var t=Y(),n=(Object(j.a)(),r.a.useState(!1)),c=Object(x.a)(n,2),o=(c[0],c[1]),s=r.a.useState(""),i=Object(x.a)(s,2),l=i[0],d=i[1];return Object(a.jsx)(V.a,{children:Object(a.jsxs)(q.a,{children:[Object(a.jsx)("div",{className:t.section1,children:Object(a.jsx)(f.a,{component:"h3",variant:"h3",color:"secondary",children:"Video Source"})}),Object(a.jsx)(X,{cameraKey:l,cameraView:e.isCameraConnected}),Object(a.jsx)(W.a,{variant:"middle"}),Object(a.jsx)("div",{className:t.section2,children:Object(a.jsx)(f.a,{variant:"subtitle1",color:"textSecondary"})}),Object(a.jsx)("div",{className:t.details,children:Object(a.jsx)(S.a,{container:!0,rows:!0,spacing:2,children:Object(a.jsx)(S.a,{item:!0,xs:6,children:!1===e.isCameraConnected?Object(a.jsx)(y.a,{"aria-label":"Start Camera",variant:"contained",fullWidth:!0,onClick:function(){Z("camera-on",o,e.setIsCameraConnected,d)},children:"Start Camera"}):Object(a.jsx)(y.a,{"aria-label":"Stop Camera",variant:"contained",fullWidth:!0,onClick:function(){Z("camera-off",o,e.setIsCameraConnected,d)},children:"Stop Camera"})})})})]})})},ee=Object(g.a)((function(e){return{root:{display:"flex"},details:{display:"flex",flexDirection:"column"},content:{flex:"1 0 auto"},controls:{display:"flex",alignItems:"center"}}})),te=function(e){var t=ee(),n=(Object(j.a)(),Object(c.useState)([])),r=Object(x.a)(n,2),o=r[0],s=r[1];Object(c.useEffect)((function(){J.a.get("".concat("http://localhost:5555/","config")).then((function(e){s(i(e.data))}))}),[]);function i(t){return t.mode&&e.setStreamingMode(t.mode),e.setIsConnected(t.streaming),e.setColumns(Object.keys(t.column_location).sort()),e.setStreamingSource(t.source),e.setDeviceID(t.device_id),e.setIsCameraConnected(t.camera_on),t.column_location="column_location"in t?Object.keys(t.column_location).sort().join(", "):[],t}return Object(a.jsx)("div",{class:t.root,children:Object(a.jsxs)(S.a,{container:!0,rows:!0,spacing:6,children:[Object(a.jsx)(S.a,{item:!0,xs:6,children:Object(a.jsx)(V.a,{children:Object(a.jsx)(q.a,{children:Object(a.jsxs)(S.a,{container:!0,columns:!0,spacing:4,children:[Object(a.jsxs)(S.a,{item:!0,xs:12,container:!0,rows:!0,spacing:2,children:[Object(a.jsx)(Q,{name:"Mode",xs:"6",value:o.mode}),Object(a.jsx)(Q,{name:"Source",xs:"6",value:o.source})]}),Object(a.jsxs)(S.a,{item:!0,xs:12,container:!0,rows:!0,spacing:2,children:[Object(a.jsx)(Q,{name:"Device ID",xs:6,value:o.device_id}),"data_capture"===o.mode?Object(a.jsx)(Q,{xs:"6",name:"Sample Rate",value:o.sample_rate}):null]}),Object(a.jsx)(S.a,{item:!0,xs:12,children:"data_capture"===o.mode?Object(a.jsx)(Q,{name:"Sensor Columns",value:o.column_location,list:!0}):null}),Object(a.jsx)(S.a,{item:!0,xs:12,children:Object(a.jsx)("div",{className:t.controls,children:e.isConnected?Object(a.jsx)(y.a,{color:"secondary",variant:"contained","aria-label":"disconnect",fullWidth:!0,onClick:function(){!function(e,t){J.a.get("".concat("http://localhost:5555/","disconnect")).then((function(e){console.log(e.data),t(i(e.data))}))}(0,s)},children:"Disconnect From Device"}):Object(a.jsx)(y.a,{color:"secondary",variant:"contained","aria-label":"connect",fullWidth:!0,onClick:function(){!function(e,t){J.a.get("".concat("http://localhost:5555/","connect")).then((function(e){t(i(e.data))}))}(0,s)},children:"Connect To Device"})})})]})})})}),Object(a.jsx)(S.a,{item:!0,xs:6,children:Object(a.jsx)($,{setIsCameraConnected:e.setIsCameraConnected,isCameraConnected:e.isCameraConnected})})]})})},ne=n(68),ae=n(232),ce=n(231),re=n(229),oe=n(289),se=n(293),ie=n(158),le=n(92),de=n(285),ue=n(290),je=n(292),be=Object(g.a)((function(e){return{root:{width:"100%"},backButton:{marginRight:e.spacing(1)},instructions:{marginTop:e.spacing(1),marginBottom:e.spacing(1)},stepIcon:{color:"primary"}}}));var he=function(e){var t=be(),n=["Select Connection Type","Scan and Select Device ID","Select Mode","Click Configure Gateway"];return Object(a.jsx)("div",{className:t.root,children:Object(a.jsx)(je.a,{activeStep:null,alternativeLabel:!0,children:n.map((function(e){return Object(a.jsx)(de.a,{color:"primary",children:Object(a.jsx)(ue.a,{active:!0,StepIconProps:{classes:{root:t.stepIcon}},children:e})},e)}))})})},pe=Object(g.a)((function(e){return{root:{display:"flex"}}})),xe=function(e){var t=pe(),n=r.a.useState(e.streamingSource),c=Object(x.a)(n,2),o=c[0],s=c[1],i=r.a.useState("results"===e.streamingMode?"config-results":"config"),l=Object(x.a)(i,2),d=l[0],u=l[1],j=r.a.useState(e.deviceID),b=Object(x.a)(j,2),h=b[0],p=b[1],O=r.a.useState(!1),m=Object(x.a)(O,2),f=m[0],g=m[1],v=r.a.useState(""),C=Object(x.a)(v,2),w=C[0],k=C[1],D=r.a.useState(""),T=Object(x.a)(D,2),R=T[0],N=T[1],_=r.a.useState([]),E=Object(x.a)(_,2),I=E[0],A=E[1];return Object(a.jsx)(V.a,{children:Object(a.jsx)(q.a,{children:Object(a.jsxs)(S.a,{container:!0,rows:!0,spacing:6,children:[Object(a.jsx)(he,{}),Object(a.jsx)(S.a,{item:!0,columns:!0,xs:6,container:!0,alignItems:"center",children:Object(a.jsx)(V.a,{children:Object(a.jsx)(q.a,{children:Object(a.jsx)("form",{onSubmit:function(e){console.log(e),e.preventDefault(),J.a.post("".concat("http://localhost:5555/","scan"),{source:o.toLowerCase()}).then((function(e){console.log(e.data),A(e.data)})).catch((function(e){e.response?(k(e.response.data.error.message.join(", ")),console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers)):e.request?console.log(e.request):console.log("Error",e.message)}))},children:Object(a.jsx)(ne.a,{component:"fieldset",error:f,children:Object(a.jsxs)(S.a,{container:!0,columns:!0,spacing:2,children:[Object(a.jsx)(S.a,{item:!0,xs:12,children:Object(a.jsx)(V.a,{children:Object(a.jsxs)(q.a,{children:[Object(a.jsx)(re.a,{children:"Connection Type"}),Object(a.jsxs)(se.a,{"aria-label":"source",value:o,onChange:function(e){s(e.target.value)},row:!0,children:[Object(a.jsx)(ae.a,{value:"SERIAL",control:Object(a.jsx)(oe.a,{}),label:"Serial"}),Object(a.jsx)(ae.a,{value:"BLE",control:Object(a.jsx)(oe.a,{}),label:"BLE"}),Object(a.jsx)(ae.a,{value:"TCPIP",control:Object(a.jsx)(oe.a,{}),label:"TCP/IP"}),Object(a.jsx)(ae.a,{value:"TEST",control:Object(a.jsx)(oe.a,{}),label:"Test"})]})]})})}),Object(a.jsx)(S.a,{item:!0,xs:12,children:Object(a.jsx)(V.a,{children:Object(a.jsxs)(q.a,{children:[Object(a.jsx)(re.a,{component:"legend",children:"Device ID:"}),Object(a.jsx)(ie.a,{id:"outlined-basic",variant:"outlined",value:h,onChange:function(e){p(e.target.value),N(" "),g(!1)},fullWidth:!0})]})})}),Object(a.jsx)(S.a,{item:!0,xs:12,children:Object(a.jsx)(y.a,{type:"submit",variant:"contained",color:"secondary",fullWidth:!0,children:"Scan"})}),Object(a.jsx)(ce.a,{children:w}),Object(a.jsx)(S.a,{item:!0,xs:12,children:Object(a.jsx)("div",{style:{height:350,width:"100%"},children:Object(a.jsx)(le.a,{rows:I,columns:[{field:"id",headerName:"ID",width:0},{field:"device_id",headerName:"Device ID",width:240},{field:"name",headerName:"Name",width:240}],onRowSelected:function(e){console.log(e.data.device_id),p(e.data.device_id)},pageSize:4})})})]})})})})})}),Object(a.jsx)(S.a,{item:!0,columns:!0,xs:6,container:!0,children:Object(a.jsx)(V.a,{children:Object(a.jsx)(q.a,{children:Object(a.jsx)("form",{onSubmit:function(t){t.preventDefault(),""!==h?(console.log(o),console.log(h),J.a.post("".concat("http://localhost:5555/","config"),{device_id:h,source:o.toLowerCase(),mode:d}).then((function(t){console.log(t.data),console.log(e),e.setStreamingMode(t.data.mode),e.setIsConnected(!0),N("Gateway Connected to device, now ready to stream.")})).catch((function(e){e.response?(N(e.response.data.error.message.join(", ")),console.log(e.response.data),console.log(e.response.status),console.log(e.response.headers)):e.request?console.log(e.request):console.log("Error",e.message)}))):N("Must Set DeviceID")},children:Object(a.jsx)(ne.a,{component:"fieldset",error:f,className:t.formControl,children:Object(a.jsxs)(S.a,{container:!0,columns:!0,spacing:2,children:[Object(a.jsx)(S.a,{item:!0,xs:12,children:Object(a.jsx)(V.a,{children:Object(a.jsxs)(q.a,{children:[Object(a.jsx)(re.a,{component:"legend",children:"Device Mode:"}),Object(a.jsxs)(se.a,{"aria-label":"mode",name:"Streaming Source",value:d,onChange:function(e){u(e.target.value)},row:!0,children:[Object(a.jsx)(ae.a,{value:"DATA_CAPTURE",control:Object(a.jsx)(oe.a,{}),label:"Data Capture"}),Object(a.jsx)(ae.a,{value:"RECOGNITION",control:Object(a.jsx)(oe.a,{}),label:"Recognition"})]})]})})}),Object(a.jsx)(S.a,{item:!0,xs:12,children:Object(a.jsx)(y.a,{type:"submit",variant:"contained",color:"primary",fullWidth:!0,children:"Configure Gateway"})}),Object(a.jsx)(ce.a,{children:R})]})})})})})})]})})})},Oe=n(287),me=n(233),fe=n(39),ge="SET_GLOBAL_LOADER",ve="FETCH_DATA_ERROR_MSG",Se="SET_DATA_ERROR_MSG",ye="START_STREAM_SENSOR_SAGA",Ce="STOP_STREAM_SENSOR_SAGA",we="SET_IS_STREAMING_SENSOR",ke="SET_IS_STREAMING_SENSOR_RECORDING",De="SET_STREAM_SENSOR_DATA_RESET",Te="SET_CHUNK_SENSOR_DATA_SAGA",Re="SET_STREAM_SENSOR_DATA",Ne="SET_STREAM_SENSOR_RECORD_DATA",_e=n(149),Ee=n.n(_e),Ie=n(148),Ae=Object(g.a)((function(e){return{linkWrapper:{display:"flex",padding:e.spacing(2),marginTop:e.spacing(2)},link:{textDecoration:"none",display:"flex",alignItems:"center",color:"#0277bd"},icon:{marginLeft:e.spacing(2),cursor:"pointer"}}})),Me=function(e){var t=e.data,n=e.deleteFile,c=e.title,r=Ae(),o={data:t,filename:"data.csv"};return Object(a.jsxs)(Oe.a,{className:r.linkWrapper,children:[Object(a.jsx)(Ie.CSVLink,Object(F.a)(Object(F.a)({className:r.link},o),{},{children:c})),Object(a.jsx)(Ee.a,{onClick:n,color:"primary",className:r.icon})]})},Le=n(150),We=n.n(Le),Ge=function(e){var t=e.sensorData,n=(e.countSamples,e.title),r=Object(c.useState)(0),o=Object(x.a)(r,2),s=o[0],i=o[1],l=Object(c.useState)("1"),d=Object(x.a)(l,2),u=d[0];d[1];return Object(c.useEffect)((function(){i(s+1),t&&t.length&&t[0].x&&t[0].x.length}),[t]),Object(a.jsx)(We.a,{data:t,revision:s,style:{width:"100%",height:"100%",opacity:u},layout:{title:n,visible:!1,autosize:!0,margin:{l:50,r:50,b:100,t:100,pad:4},xaxis:{autorange:!0},yaxis:{autorange:!0}}})},ze=Object(g.a)((function(e){return{cardWrapper:{padding:e.spacing(2)},dataWrapper:{padding:e.spacing(2)},chartWrapper:{width:"100%",margin:e.spacing(1)},buttonWrapper:{display:"flex",marginTop:e.spacing(2)},button:{marginLeft:e.spacing(2)},zeroOpacity:{opacity:"0"}}})),Be=function(e){var t,n=16e3,r=e.columns,o=ze(),s=Object(fe.b)(),i=Object(c.useState)(!1),l=Object(x.a)(i,2),d=l[0],u=l[1],j=Object(fe.c)((function(e){return e.stream})),b=j.isStreamingSensor,h=j.isStreamingSensorRecording,p=Object(fe.c)((t=r,function(e){var n=e.sensorData.sensorSimpleData,a=t.map((function(e){return{x:[],y:[],type:"scatter",mode:"lines",name:e}}));return n.forEach((function(e,n){a[n%t.length].x.push(Math.floor(n/t.length)),a[n%t.length].y.push(e)})),a})),O=Object(fe.c)(function(e){return function(t){var n=t.sensorData.sensorRecordedData,a=e.map((function(e){return[e]}));return a.unshift(["column"]),n.forEach((function(t,n){a[n%e.length+1].push(t)})),[a,n.length]}}(r)),m=Object(x.a)(O,2),g=m[0],v=m[1],C=Object(c.useCallback)((function(){return s({type:ye,payload:{countSamples:n*(r&&(null===r||void 0===r?void 0:r.length)||1)}})}),[s]),w=Object(c.useCallback)((function(){return s({type:Ce})}),[s]),k=Object(c.useCallback)((function(e){return s({type:ke,payload:e})}),[s]),D=Object(c.useCallback)((function(e){return s({type:Ne,payload:[]})}),[s]),T=Object(c.useCallback)((function(){return s({type:De,payload:[]})}),[s]);return Object(a.jsx)(S.a,{children:Object(a.jsx)(V.a,{children:Object(a.jsxs)(q.a,{children:[Object(a.jsx)(f.a,{component:"h3",variant:"h3",color:"secondary",children:"Test Mode: Data Capture"}),Object(a.jsxs)(Oe.a,{className:o.dataWrapper,children:[Object(a.jsxs)(Oe.a,{className:o.chartWrapper,children:[Object(a.jsxs)(Oe.a,{className:!b&&o.zeroOpacity,children:[Object(a.jsx)(me.a,{checked:d,onChange:function(){u(!d)},inputProps:{"aria-label":"secondary checkbox"}})," ","Split charts"]}),p&&p.length&&d?p.map((function(e){return Object(a.jsx)(Ge,{title:e.name,countSamples:n,sensorData:[e],isStreamingSensor:b})})):Object(a.jsx)(Ge,{countSamples:n,sensorData:p,isStreamingSensor:b})]}),Object(a.jsxs)(Oe.a,{className:o.buttonWrapper,children:[Object(a.jsx)(y.a,{variant:"contained",color:"primary",className:o.button,onClick:function(){return console.log("streaming",b),void(b?(k(!1),w()):(T(),C()))},children:b?"Stop":"View"}),Object(a.jsx)(y.a,{variant:"outlined",disabled:!b,className:o.button,onClick:function(){return h||D(),void k(!h)},children:h?"Stop Recording":"Record"})]}),Object(a.jsx)(Oe.a,{children:v?Object(a.jsx)(Me,{data:g,title:"Export Recorded items ".concat(v," to CSV"),deleteFile:function(){D()}}):null})]})]})})})},Pe=n(22),Fe=n(294),Ue=function(e){return Object(a.jsx)(f.a,{align:"center",variant:"h1",component:"h2",children:function(e,t){if(0===e.length)return"No Results";t>e.length&&(t=e.length-1);for(var n={},a=e.length-t;a<e.length;a++)e[a].Classification in n?n[e[a].Classification]+=1:n[e[a].Classification]=1;for(var c=0,r=0,o=0,s=Object.entries(n);o<s.length;o++){var i=Object(x.a)(s[o],2),l=i[0],d=i[1];d>r&&(r=d,c=l)}return r<t/2?"UNC":c}(e.data,e.filter_length)})},qe=0,Ve=Object(g.a)((function(e){return{controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)},root:{width:"800px"},sliderroot:{width:"100%"},sliderinput:{width:42},section1:{margin:e.spacing(3,2)},section2:{margin:e.spacing(2),textAlign:"center"}}}));var He=function(e,t,n,a,c){qe=0,n([]),a(!0),fetch(t,{method:"GET"}).then((function(e){var t=e.body.getReader();c(t);var r=new ReadableStream({start:function(e){!function c(){t.read().then((function(t){var r=t.done,o=t.value;if(r)return a(!1),void e.close();for(var s=function(e){var t=String.fromCharCode.apply(null,e).split("\n");return t.pop(),t.map((function(e){return JSON.parse(e)}))}(o),i=0;i<s.length;i++)console.log(s[i]),s[i].id=qe,qe+=1,n((function(e){return[].concat(Object(Pe.a)(e),[s[i]])}));c()}))}()}});return new Response(r,{headers:{"Content-Type":"text/html"}})}))};var Je=function(e){var t=r.a.useState([]),n=Object(x.a)(t,2),c=n[0],o=n[1],s=r.a.useState(!1),i=Object(x.a)(s,2),l=i[0],d=i[1],u=r.a.useState(),b=Object(x.a)(u,2),h=b[0],p=b[1],O=r.a.useState(1),m=Object(x.a)(O,2),g=m[0],v=m[1],C=Ve();Object(j.a)();return Object(a.jsx)("div",{className:C.root,children:Object(a.jsx)(V.a,{children:Object(a.jsxs)(q.a,{children:[Object(a.jsxs)("div",{className:C.section1,children:[Object(a.jsx)(S.a,{item:!0,xs:12,children:Object(a.jsx)(f.a,{align:"center",component:"h2",variant:"h2",color:"secondary",children:"Test Mode: Recognition"})}),Object(a.jsx)("div",{className:C.section1,children:Object(a.jsx)(W.a,{variant:"middle"})}),Object(a.jsx)(S.a,{item:!0,xs:12,children:l?Object(a.jsx)("div",{className:C.controls,children:Object(a.jsx)(y.a,{"aria-label":"disconnect",color:"primary",variant:"contained",fullWidth:!0,onClick:function(){!function(e,t,n){console.log(t),t.cancel(),n(!1)}(0,h,d)},children:"Stop Stream"})}):Object(a.jsx)("div",{className:C.controls,children:Object(a.jsx)(y.a,{"aria-label":"disconnect",color:"primary",variant:"contained",fullWidth:!0,onClick:function(){He(0,"".concat("http://localhost:5555/","results"),o,d,p)},children:"Start Stream"})})})]}),Object(a.jsx)(S.a,{item:!0,alignContent:"center",xs:12,children:Object(a.jsx)(Ue,{data:c,filter_length:g})}),Object(a.jsx)(W.a,{variant:"middle"}),Object(a.jsx)("div",{className:C.section1,children:Object(a.jsxs)(S.a,{container:!0,spacing:4,rows:!0,alignItems:"center",children:[Object(a.jsx)(S.a,{item:!0,xs:4,children:Object(a.jsxs)(f.a,{align:"center",component:"h6",variant:"h6",children:["Filter Length"," "]})}),Object(a.jsx)(S.a,{item:!0,xs:6,children:Object(a.jsx)("div",{className:C.sliderroot,children:Object(a.jsx)(Fe.a,{value:"number"===typeof g?g:1,onChange:function(e,t){console.log(t),v(t)},"aria-labelledby":"input-slider",min:1,max:10})})}),Object(a.jsx)(S.a,{item:!0,xs:1,children:Object(a.jsx)(f.a,{align:"center",component:"h6",variant:"h6",children:g})})]})}),Object(a.jsx)("div",{className:C.section1,children:Object(a.jsx)("div",{style:{height:600,width:"100%"},children:Object(a.jsx)(le.a,{rows:c,columns:[{field:"id",headerName:"ID",width:70},{field:"ModelNumber",headerName:"Model ID",width:240},{field:"Classification",headerName:"Classification",width:240}],pageSize:15,sortModel:[{field:"id",sort:"desc"}]})})})]})})})},Ke=n(286),Qe=n(96),Xe=Object(g.a)((function(e){return{root:{display:"flex"},details:{display:"flex",flexDirection:"column"},content:{flex:"1 0 auto"},controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingBottom:e.spacing(1)},section1:{margin:e.spacing(3,2)},section2:{margin:e.spacing(2),textAlign:"center"}}})),Ye=function(e,t,n){console.log(e),""===n&&(n="test"),console.log(n),J.a.post("".concat("http://localhost:5555/","record"),{filename:n,event_type:e}).then((function(n){console.log(n.data),"record-start"==e&&(t(!0),console.log(e)),"record-stop"==e&&(t(!1),console.log(e))}))},Ze=function(e){var t=Xe(),n=(Object(j.a)(),r.a.useState(e.isCameraConnected)),c=Object(x.a)(n,2),o=(c[0],c[1]),s=r.a.useState(!1),i=Object(x.a)(s,2),l=i[0],d=i[1],u=r.a.useState("capture_name"),b=Object(x.a)(u,2),h=b[0],p=b[1];return Object(a.jsx)(V.a,{children:Object(a.jsxs)(q.a,{children:[Object(a.jsx)("div",{className:t.section1,children:Object(a.jsx)(f.a,{component:"h3",variant:"h3",color:"secondary",children:"Record Source and Video"})}),Object(a.jsx)(W.a,{variant:"middle"}),Object(a.jsx)("div",{className:t.section2,children:Object(a.jsx)(f.a,{variant:"subtitle1",color:"textSecondary"})}),Object(a.jsx)(V.a,{children:Object(a.jsx)(q.a,{children:Object(a.jsxs)(S.a,{container:!0,columns:!0,spacing:6,xs:6,children:[Object(a.jsx)(S.a,{item:!0,xs:12,children:Object(a.jsx)(ie.a,{id:"outlined-basic",variant:"outlined",value:h,onChange:function(e){p(e.target.value)},fullWidth:!0,disabled:l})}),Object(a.jsx)(S.a,{item:!0,xs:6,children:!1===l?Object(a.jsx)(y.a,{"aria-label":"Record",variant:"contained",fullWidth:!0,disabled:!o,onClick:function(){Ye("record-start",d,h)},children:"Record"}):Object(a.jsx)(y.a,{"aria-label":"Stop ",variant:"contained",fullWidth:!0,onClick:function(){Ye("record-stop",d)},children:"Stop Recording"})}),Object(a.jsx)(S.a,{item:!0,xs:6,children:Object(a.jsx)(y.a,{"aria-label":"Download ",variant:"contained",fullWidth:!0,onClick:function(){!function(e,t){console.log("".concat("http://localhost:5555/","download/")+t),fetch("".concat("http://localhost:5555/","download/")+t,{method:"GET",headers:{"Content-Type":"application/zip"}}).then((function(e){return e.blob()})).then((function(e){var n=window.URL.createObjectURL(new Blob([e])),a=document.createElement("a");a.href=n,a.setAttribute("download",t+".zip"),document.body.appendChild(a),a.click(),a.parentNode.removeChild(a)}))}(0,h)},children:"Download"})})]})})})]})})},$e=function(){var e=Object(fe.b)(),t=r.a.useState(0),n=Object(x.a)(t,2),o=n[0],s=n[1],i=r.a.useState(0),l=Object(x.a)(i,2),d=l[0],u=l[1],j=r.a.useState(0),b=Object(x.a)(j,2),h=b[0],p=b[1],O=r.a.useState([]),m=Object(x.a)(O,2),f=m[0],g=m[1],y=r.a.useState([]),C=Object(x.a)(y,2),w=C[0],k=C[1],D=r.a.useState(!1),T=Object(x.a)(D,2),R=T[0],N=T[1],_=r.a.useState(!1),E=Object(x.a)(_,2),I=E[0],A=E[1],M=Object(Qe.b)(),L=M.enqueueSnackbar,W=(M.closeSnackbar,Object(fe.c)((function(e){return e.stream})).isStreamingSensor),G=Object(fe.c)((function(e){return e.errors})).errorDataMsg;Object(c.useEffect)((function(){J.a.get("".concat("http://localhost:5555/","config"),{}).then((function(e){A(e.data.camera_on),N(e.data.streaming)}))}));var z=function(e){W&&(e.preventDefault(),e.returnValue="")},B=Object(c.useCallback)((function(){return e({type:Ce})}),[e]);Object(c.useEffect)((function(){if(W)return window.addEventListener("beforeunload",z),window.addEventListener("unload",B),function(){window.removeEventListener("beforeunload",z),window.removeEventListener("unload",B),B()}}),[W]),Object(c.useEffect)((function(){G&&L(G,{variant:"warning"})}),[G]);var F=U();return Object(a.jsxs)("div",{className:F.root,children:[Object(a.jsx)(Ke.a,{}),Object(a.jsxs)(S.a,{container:!0,direction:"column",justify:"center",alignItems:"center",children:[Object(a.jsx)(v,{}),Object(a.jsx)(P,{onChange:function(e){o!==e&&s(e)},isConnected:R,isCameraConnected:I}),Object(a.jsxs)("main",{className:F.content,children:[0===o?Object(a.jsx)(te,{setStreamingMode:u,setColumns:g,setStreamingSource:p,setDeviceID:k,setIsConnected:N,isConnected:R,setIsCameraConnected:A,isCameraConnected:I}):null,3===o?Object(a.jsx)(xe,{setStreamingMode:u,streamingSource:h,streamingMode:d,deviceID:w,setIsConnected:N}):null,1===o?"recognition"==d?Object(a.jsx)(Je,{}):Object(a.jsx)(Be,{columns:f}):null,2===o?Object(a.jsx)(Ze,{}):null]})]})]})},et=n(153),tt=n(40),nt=n(151),at=n(15),ct=n.n(at),rt=n(18),ot=ct.a.mark(it),st=ct.a.mark(lt);function it(e){return ct.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(rt.e)({type:Se,payload:e.payload});case 2:return t.next=4,Object(rt.c)(1e3);case 4:return t.next=6,Object(rt.e)({type:Se,payload:null});case 6:case"end":return t.stop()}}),ot)}function lt(){return ct.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(rt.g)(ve,it);case 2:case"end":return e.stop()}}),st)}var dt=n(66),ut=n(55),jt=n(77),bt=n(93),ht=n(97),pt=n(154),xt=function(e){Object(bt.a)(n,e);var t=Object(ht.a)(n);function n(e,a){var c;return Object(ut.a)(this,n),(c=t.call(this)).message=500!==e?a.message:"Server Error. Please, contact support.",c.name=c.constructor.name,c.errorCode=e,c}return n}(Object(pt.a)(Error)),Ot=function(){function e(t){Object(ut.a)(this,e),this.reader=void 0,this.fetchUrl=t}return Object(jt.a)(e,[{key:"startStreaming",value:function(){var e=Object(dt.a)(ct.a.mark((function e(){var t;return ct.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("getting response"),e.prev=1,e.next=4,fetch(this.fetchUrl);case 4:t=e.sent,e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(1),console.log(e.t0),new xt(404,{message:"Failed to fetch API service"});case 11:if(t.ok){e.next=13;break}throw new xt(t.status,{message:t.statusText});case 13:console.log("getting reader"),this.reader=t.body.getReader();case 15:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"stopStreaming",value:function(){var e=Object(dt.a)(ct.a.mark((function e(){return ct.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.reader&&(this.reader.cancel(),this.reader=void 0);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"readStreamToRedux",value:function(){var e=Object(dt.a)(ct.a.mark((function e(t){var n,a,c,r=arguments;return ct.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=r.length>1&&void 0!==r[1]?r[1]:0;case 1:return e.next=4,this.reader.read();case 4:if(a=e.sent,c=a.value,!a.done){e.next=9;break}return e.abrupt("break",12);case 9:Zt.dispatch({type:t,payload:{chunk:new Int16Array(c.buffer),countSamples:n}}),e.next=1;break;case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),mt="http://localhost:5555/",ft=void 0,gt=ct.a.mark(St),vt=ct.a.mark(yt);function St(e){var t,n;return ct.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,t=null===e||void 0===e?void 0:e.payload,n=t.countSamples,a.next=4,Object(rt.b)([ft,"startStreaming"]);case 4:return a.next=6,Object(rt.e)({type:we,payload:!0});case 6:return a.next=8,Object(rt.b)([ft,"readStreamToRedux"],Te,n);case 8:a.next=20;break;case 10:if(a.prev=10,a.t0=a.catch(0),console.debug(a.t0),!(a.t0 instanceof xt)){a.next=18;break}return a.next=16,Object(rt.e)({type:ve,payload:a.t0.message});case 16:a.next=20;break;case 18:return a.next=20,Object(rt.e)({type:ve,payload:"Failed to read stream data"});case 20:case"end":return a.stop()}}),gt,null,[[0,10]])}function yt(){return ct.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(rt.h)(ye,St);case 2:case"end":return e.stop()}}),vt)}var Ct=ct.a.mark(kt),wt=ct.a.mark(Dt);function kt(e){return ct.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(rt.b)([ft,"stopStreaming"]);case 3:return e.next=5,Object(rt.e)({type:we,payload:!1});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.debug(e.t0);case 10:case"end":return e.stop()}}),Ct,null,[[0,7]])}function Dt(){return ct.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(rt.h)(Ce,kt);case 2:case"end":return e.stop()}}),wt)}var Tt=ct.a.mark(Rt);function Rt(){return ct.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(rt.a)([Object(rt.d)(yt),Object(rt.d)(Dt)]);case 2:case"end":return e.stop()}}),Tt)}var Nt=ct.a.mark(Et),_t=ct.a.mark(It);function Et(e){var t,n,a,c,r,o,s,i,l,d,u,j,b,h;return ct.a.wrap((function(p){for(;;)switch(p.prev=p.next){case 0:return p.prev=0,t=e.payload,n=t.chunk,a=t.countSamples,c=n&&n.length||0,r=[],p.next=6,Object(rt.f)((function(e){return e.sensorData}));case 6:return o=p.sent,s=o.sensorSimpleData,i=o.sensorRecordedData,p.next=11,Object(rt.f)((function(e){return e.stream}));case 11:if(l=p.sent,d=l.isStreamingSensorRecording,console.log("called",c/12),c>=a)r=Object(Pe.a)(n);else if(s.length>=a)for(r=Object(Pe.a)(s),u=[0,s.length,0],j=u[0],b=u[1],h=u[2];j<b;)b-j>c?r[j]=s[j+c]:(r[j]=n[h],h++),j++;else r=[].concat(Object(Pe.a)(s),Object(Pe.a)(n));return p.next=17,Object(rt.e)({type:Re,payload:r});case 17:if(!d){p.next=20;break}return p.next=20,Object(rt.e)({type:Ne,payload:[].concat(Object(Pe.a)(i),Object(Pe.a)(n))});case 20:p.next=25;break;case 22:p.prev=22,p.t0=p.catch(0),console.debug(p.t0);case 25:case"end":return p.stop()}}),Nt,null,[[0,22]])}function It(){return ct.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(rt.h)(Te,Et);case 2:case"end":return e.stop()}}),_t)}var At=ct.a.mark(Mt);function Mt(){return ct.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(rt.a)([Object(rt.d)(It)]);case 2:case"end":return e.stop()}}),At)}var Lt=ct.a.mark(Wt);function Wt(){return ct.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(rt.a)([Object(rt.d)(Rt),Object(rt.d)(lt),Object(rt.d)(Mt)]);case 2:case"end":return e.stop()}}),Lt)}var Gt={globalLoader:!1};function zt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Gt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ge:return Object(F.a)(Object(F.a)({},e),{},{globalLoader:t.payload||!1});default:return e}}var Bt={errorDataMsg:null};function Pt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Se:return Object(F.a)(Object(F.a)({},e),{},{errorDataMsg:t.payload});default:return e}}var Ft={isStreamingSensor:!1,isStreamingSensorRecording:!1};function Ut(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ft,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case we:return Object(F.a)(Object(F.a)({},e),{},{isStreamingSensor:t.payload});case ke:return Object(F.a)(Object(F.a)({},e),{},{isStreamingSensorRecording:t.payload});default:return e}}var qt={sensorSimpleData:new Int16Array,sensorRecordedData:new Int16Array};function Vt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:qt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case De:return Object(F.a)(Object(F.a)({},e),{},{sensorSimpleData:new Int16Array,sensorRecordedData:new Int16Array});case Re:return Object(F.a)(Object(F.a)({},e),{},{sensorSimpleData:Object(Pe.a)(t.payload)});case Ne:return Object(F.a)(Object(F.a)({},e),{},{sensorRecordedData:Object(Pe.a)(t.payload)});default:return e}}var Ht=function(){return Object(tt.combineReducers)({root:zt,errors:Pt,stream:Ut,sensorData:Vt})},Jt=Object(et.a)(),Kt=[Jt],Qt=nt.composeWithDevTools.apply(void 0,[tt.applyMiddleware.apply(void 0,Kt)].concat([])),Xt=Ht(),Yt=Object(tt.createStore)(Xt,Qt);Jt.run(Wt);var Zt=Yt;({interceptor_401:null,refreshUrl:"/auth/refresh",init:function(e){J.a.defaults.baseURL=e},mount401Interceptor:function(){this.interceptor_401=J.a.interceptors.response.use((function(e){return e}),function(){var e=Object(dt.a)(ct.a.mark((function e(t){return ct.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(401!==t.request.status){e.next=5;break}if(!t.config.url.includes("auth")){e.next=5;break}throw t;case 5:throw t;case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},unmount401Interceptor:function(){J.a.interceptors.response.eject(this.interceptor_401)},setCustomAuthHeader:function(e){J.a.defaults.headers.common.Authorization=e},setContentType:function(e){J.a.defaults.headers.contentType=e},removeHeader:function(){J.a.defaults.headers.common={}},get:function(e){return J.a.get(e)},post:function(e,t){return J.a.post(e,t)},put:function(e,t){return J.a.put(e,t)},delete:function(e){return J.a.delete(e)},customRequest:function(e){return J()(e)},customJsonRequest:function(e){return this.setAuthHeader(),this.setContentType("application/json"),J()(e)}}).init(mt),ft=new Ot("".concat(mt,"/stream"));var $t=function(){return Object(a.jsx)(p,{children:Object(a.jsx)(fe.a,{store:Zt,children:Object(a.jsx)(Qe.a,{anchorOrigin:{horizontal:"right",vertical:"top"},autoHideDuration:2e3,children:Object(a.jsx)($e,{})})})})};s.a.render(Object(a.jsx)($t,{}),document.getElementById("root"))}},[[222,1,2]]]);
//# sourceMappingURL=main.1c4d9686.chunk.js.map